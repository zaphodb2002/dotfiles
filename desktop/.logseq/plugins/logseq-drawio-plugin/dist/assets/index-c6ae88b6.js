(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))q(P);new MutationObserver(P=>{for(const J of P)if(J.type==="childList")for(const I of J.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&q(I)}).observe(document,{childList:!0,subtree:!0});function O(P){const J={};return P.integrity&&(J.integrity=P.integrity),P.referrerPolicy&&(J.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?J.credentials="include":P.crossOrigin==="anonymous"?J.credentials="omit":J.credentials="same-origin",J}function q(P){if(P.ep)return;P.ep=!0;const J=O(P);fetch(P.href,J)}})();var Nn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _i(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Dn={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */Dn.exports;(function(c,f){(function(O,q){c.exports=q()})(self,()=>(()=>{var O={227:(I,d,y)=>{var _=y(155);d.formatArgs=function(E){if(E[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+E[0]+(this.useColors?"%c ":" ")+"+"+I.exports.humanize(this.diff),!this.useColors)return;const G="color: "+this.color;E.splice(1,0,G,"color: inherit");let b=0,p=0;E[0].replace(/%[a-zA-Z%]/g,x=>{x!=="%%"&&(b++,x==="%c"&&(p=b))}),E.splice(p,0,G)},d.save=function(E){try{E?d.storage.setItem("debug",E):d.storage.removeItem("debug")}catch{}},d.load=function(){let E;try{E=d.storage.getItem("debug")}catch{}return!E&&_!==void 0&&"env"in _&&(E=_.env.DEBUG),E},d.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},d.storage=function(){try{return localStorage}catch{}}(),d.destroy=(()=>{let E=!1;return()=>{E||(E=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),d.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],d.log=console.debug||console.log||(()=>{}),I.exports=y(447)(d);const{formatters:v}=I.exports;v.j=function(E){try{return JSON.stringify(E)}catch(G){return"[UnexpectedJSONParseError]: "+G.message}}},447:(I,d,y)=>{I.exports=function(_){function v(b){let p,x,m,$=null;function L(...M){if(!L.enabled)return;const V=L,F=Number(new Date),z=F-(p||F);V.diff=z,V.prev=p,V.curr=F,p=F,M[0]=v.coerce(M[0]),typeof M[0]!="string"&&M.unshift("%O");let s=0;M[0]=M[0].replace(/%([a-zA-Z%])/g,(l,C)=>{if(l==="%%")return"%";s++;const T=v.formatters[C];if(typeof T=="function"){const K=M[s];l=T.call(V,K),M.splice(s,1),s--}return l}),v.formatArgs.call(V,M),(V.log||v.log).apply(V,M)}return L.namespace=b,L.useColors=v.useColors(),L.color=v.selectColor(b),L.extend=E,L.destroy=v.destroy,Object.defineProperty(L,"enabled",{enumerable:!0,configurable:!1,get:()=>$!==null?$:(x!==v.namespaces&&(x=v.namespaces,m=v.enabled(b)),m),set:M=>{$=M}}),typeof v.init=="function"&&v.init(L),L}function E(b,p){const x=v(this.namespace+(p===void 0?":":p)+b);return x.log=this.log,x}function G(b){return b.toString().substring(2,b.toString().length-2).replace(/\.\*\?$/,"*")}return v.debug=v,v.default=v,v.coerce=function(b){return b instanceof Error?b.stack||b.message:b},v.disable=function(){const b=[...v.names.map(G),...v.skips.map(G).map(p=>"-"+p)].join(",");return v.enable(""),b},v.enable=function(b){let p;v.save(b),v.namespaces=b,v.names=[],v.skips=[];const x=(typeof b=="string"?b:"").split(/[\s,]+/),m=x.length;for(p=0;p<m;p++)x[p]&&((b=x[p].replace(/\*/g,".*?"))[0]==="-"?v.skips.push(new RegExp("^"+b.slice(1)+"$")):v.names.push(new RegExp("^"+b+"$")))},v.enabled=function(b){if(b[b.length-1]==="*")return!0;let p,x;for(p=0,x=v.skips.length;p<x;p++)if(v.skips[p].test(b))return!1;for(p=0,x=v.names.length;p<x;p++)if(v.names[p].test(b))return!0;return!1},v.humanize=y(824),v.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(_).forEach(b=>{v[b]=_[b]}),v.names=[],v.skips=[],v.formatters={},v.selectColor=function(b){let p=0;for(let x=0;x<b.length;x++)p=(p<<5)-p+b.charCodeAt(x),p|=0;return v.colors[Math.abs(p)%v.colors.length]},v.enable(v.load()),v}},856:function(I){I.exports=function(){function d(k){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},d(k)}function y(k,N){return y=Object.setPrototypeOf||function(Y,ee){return Y.__proto__=ee,Y},y(k,N)}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(k,N,Y){return v=_()?Reflect.construct:function(ee,ce,Ne){var Ke=[null];Ke.push.apply(Ke,ce);var Pe=new(Function.bind.apply(ee,Ke));return Ne&&y(Pe,Ne.prototype),Pe},v.apply(null,arguments)}function E(k){return G(k)||b(k)||p(k)||m()}function G(k){if(Array.isArray(k))return x(k)}function b(k){if(typeof Symbol<"u"&&k[Symbol.iterator]!=null||k["@@iterator"]!=null)return Array.from(k)}function p(k,N){if(k){if(typeof k=="string")return x(k,N);var Y=Object.prototype.toString.call(k).slice(8,-1);return Y==="Object"&&k.constructor&&(Y=k.constructor.name),Y==="Map"||Y==="Set"?Array.from(k):Y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Y)?x(k,N):void 0}}function x(k,N){(N==null||N>k.length)&&(N=k.length);for(var Y=0,ee=new Array(N);Y<N;Y++)ee[Y]=k[Y];return ee}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $=Object.hasOwnProperty,L=Object.setPrototypeOf,M=Object.isFrozen,V=Object.getPrototypeOf,F=Object.getOwnPropertyDescriptor,z=Object.freeze,s=Object.seal,l=Object.create,C=typeof Reflect<"u"&&Reflect,T=C.apply,K=C.construct;T||(T=function(k,N,Y){return k.apply(N,Y)}),z||(z=function(k){return k}),s||(s=function(k){return k}),K||(K=function(k,N){return v(k,E(N))});var ne=oe(Array.prototype.forEach),ae=oe(Array.prototype.pop),ge=oe(Array.prototype.push),xe=oe(String.prototype.toLowerCase),Ce=oe(String.prototype.match),he=oe(String.prototype.replace),Fe=oe(String.prototype.indexOf),g=oe(String.prototype.trim),S=oe(RegExp.prototype.test),B=Se(TypeError);function oe(k){return function(N){for(var Y=arguments.length,ee=new Array(Y>1?Y-1:0),ce=1;ce<Y;ce++)ee[ce-1]=arguments[ce];return T(k,N,ee)}}function Se(k){return function(){for(var N=arguments.length,Y=new Array(N),ee=0;ee<N;ee++)Y[ee]=arguments[ee];return K(k,Y)}}function H(k,N){L&&L(k,null);for(var Y=N.length;Y--;){var ee=N[Y];if(typeof ee=="string"){var ce=xe(ee);ce!==ee&&(M(N)||(N[Y]=ce),ee=ce)}k[ee]=!0}return k}function X(k){var N,Y=l(null);for(N in k)T($,k,[N])&&(Y[N]=k[N]);return Y}function ue(k,N){for(;k!==null;){var Y=F(k,N);if(Y){if(Y.get)return oe(Y.get);if(typeof Y.value=="function")return oe(Y.value)}k=V(k)}function ee(ce){return console.warn("fallback value for",ce),null}return ee}var je=z(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ae=z(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qe=z(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nt=z(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pe=z(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),fe=z(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ke=z(["#text"]),Oe=z(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Te=z(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Le=z(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ue=z(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Lt=s(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xt=s(/<%[\w\W]*|[\w\W]*%>/gm),$n=s(/^data-[\-\w.\u00B7-\uFFFF]/),zn=s(/^aria-[\-\w]+$/),qn=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Bn=s(/^(?:\w+script|data):/i),rt=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),un=s(/^html$/i),Hn=function(){return typeof window>"u"?null:window},Wn=function(k,N){if(d(k)!=="object"||typeof k.createPolicy!="function")return null;var Y=null,ee="data-tt-policy-suffix";N.currentScript&&N.currentScript.hasAttribute(ee)&&(Y=N.currentScript.getAttribute(ee));var ce="dompurify"+(Y?"#"+Y:"");try{return k.createPolicy(ce,{createHTML:function(Ne){return Ne}})}catch{return console.warn("TrustedTypes policy "+ce+" could not be created."),null}};function ft(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hn(),N=function(o){return ft(o)};if(N.version="2.3.8",N.removed=[],!k||!k.document||k.document.nodeType!==9)return N.isSupported=!1,N;var Y=k.document,ee=k.document,ce=k.DocumentFragment,Ne=k.HTMLTemplateElement,Ke=k.Node,Pe=k.Element,Xe=k.NodeFilter,dt=k.NamedNodeMap,Ct=dt===void 0?k.NamedNodeMap||k.MozNamedAttrMap:dt,Nt=k.HTMLFormElement,fn=k.DOMParser,dn=k.trustedTypes,ht=Pe.prototype,hn=ue(ht,"cloneNode"),pn=ue(ht,"nextSibling"),Gn=ue(ht,"childNodes"),ot=ue(ht,"parentNode");if(typeof Ne=="function"){var Pt=ee.createElement("template");Pt.content&&Pt.content.ownerDocument&&(ee=Pt.content.ownerDocument)}var Be=Wn(dn,Y),mn=Be?Be.createHTML(""):"",pt=ee,Ut=pt.implementation,gn=pt.createNodeIterator,vn=pt.createDocumentFragment,Jn=pt.getElementsByTagName,Rt=Y.importNode,yn={};try{yn=X(ee).documentMode?ee.documentMode:{}}catch{}var be={};N.isSupported=typeof ot=="function"&&Ut&&Ut.createHTMLDocument!==void 0&&yn!==9;var it,He,Dt=Lt,$t=xt,Et=$n,Me=zn,zt=Bn,mt=rt,qt=qn,ve=null,Bt=H({},[].concat(E(je),E(Ae),E(qe),E(pe),E(ke))),ye=null,Ht=H({},[].concat(E(Oe),E(Te),E(Le),E(Ue))),le=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),gt=null,Wt=null,Gt=!0,Jt=!0,bn=!1,st=!1,re=!1,Yt=!1,Vt=!1,Qe=!1,We=!1,at=!1,Zt=!0,St=!0,et=!1,Ge={},ct=null,_n=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),wn=null,xn=H({},["audio","video","img","source","image","track"]),Kt=null,At=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xt="http://www.w3.org/1998/Math/MathML",kt="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml",Ot=Je,Cn=!1,En=["application/xhtml+xml","text/html"],Yn="text/html",lt=null,Vn=ee.createElement("form"),jt=function(o){return o instanceof RegExp||o instanceof Function},Qt=function(o){lt&&lt===o||(o&&d(o)==="object"||(o={}),o=X(o),ve="ALLOWED_TAGS"in o?H({},o.ALLOWED_TAGS):Bt,ye="ALLOWED_ATTR"in o?H({},o.ALLOWED_ATTR):Ht,Kt="ADD_URI_SAFE_ATTR"in o?H(X(At),o.ADD_URI_SAFE_ATTR):At,wn="ADD_DATA_URI_TAGS"in o?H(X(xn),o.ADD_DATA_URI_TAGS):xn,ct="FORBID_CONTENTS"in o?H({},o.FORBID_CONTENTS):_n,gt="FORBID_TAGS"in o?H({},o.FORBID_TAGS):{},Wt="FORBID_ATTR"in o?H({},o.FORBID_ATTR):{},Ge="USE_PROFILES"in o&&o.USE_PROFILES,Gt=o.ALLOW_ARIA_ATTR!==!1,Jt=o.ALLOW_DATA_ATTR!==!1,bn=o.ALLOW_UNKNOWN_PROTOCOLS||!1,st=o.SAFE_FOR_TEMPLATES||!1,re=o.WHOLE_DOCUMENT||!1,Qe=o.RETURN_DOM||!1,We=o.RETURN_DOM_FRAGMENT||!1,at=o.RETURN_TRUSTED_TYPE||!1,Vt=o.FORCE_BODY||!1,Zt=o.SANITIZE_DOM!==!1,St=o.KEEP_CONTENT!==!1,et=o.IN_PLACE||!1,qt=o.ALLOWED_URI_REGEXP||qt,Ot=o.NAMESPACE||Je,o.CUSTOM_ELEMENT_HANDLING&&jt(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&jt(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),it=it=En.indexOf(o.PARSER_MEDIA_TYPE)===-1?Yn:o.PARSER_MEDIA_TYPE,He=it==="application/xhtml+xml"?function(j){return j}:xe,st&&(Jt=!1),We&&(Qe=!0),Ge&&(ve=H({},E(ke)),ye=[],Ge.html===!0&&(H(ve,je),H(ye,Oe)),Ge.svg===!0&&(H(ve,Ae),H(ye,Te),H(ye,Ue)),Ge.svgFilters===!0&&(H(ve,qe),H(ye,Te),H(ye,Ue)),Ge.mathMl===!0&&(H(ve,pe),H(ye,Le),H(ye,Ue))),o.ADD_TAGS&&(ve===Bt&&(ve=X(ve)),H(ve,o.ADD_TAGS)),o.ADD_ATTR&&(ye===Ht&&(ye=X(ye)),H(ye,o.ADD_ATTR)),o.ADD_URI_SAFE_ATTR&&H(Kt,o.ADD_URI_SAFE_ATTR),o.FORBID_CONTENTS&&(ct===_n&&(ct=X(ct)),H(ct,o.FORBID_CONTENTS)),St&&(ve["#text"]=!0),re&&H(ve,["html","head","body"]),ve.table&&(H(ve,["tbody"]),delete gt.tbody),z&&z(o),lt=o)},en=H({},["mi","mo","mn","ms","mtext"]),Sn=H({},["foreignobject","desc","title","annotation-xml"]),Zn=H({},["title","style","font","a","script"]),It=H({},Ae);H(It,qe),H(It,nt);var tn=H({},pe);H(tn,fe);var Kn=function(o){var j=ot(o);j&&j.tagName||(j={namespaceURI:Je,tagName:"template"});var A=xe(o.tagName),ie=xe(j.tagName);return o.namespaceURI===kt?j.namespaceURI===Je?A==="svg":j.namespaceURI===Xt?A==="svg"&&(ie==="annotation-xml"||en[ie]):!!It[A]:o.namespaceURI===Xt?j.namespaceURI===Je?A==="math":j.namespaceURI===kt?A==="math"&&Sn[ie]:!!tn[A]:o.namespaceURI===Je&&!(j.namespaceURI===kt&&!Sn[ie])&&!(j.namespaceURI===Xt&&!en[ie])&&!tn[A]&&(Zn[A]||!It[A])},Re=function(o){ge(N.removed,{element:o});try{o.parentNode.removeChild(o)}catch{try{o.outerHTML=mn}catch{o.remove()}}},An=function(o,j){try{ge(N.removed,{attribute:j.getAttributeNode(o),from:j})}catch{ge(N.removed,{attribute:null,from:j})}if(j.removeAttribute(o),o==="is"&&!ye[o])if(Qe||We)try{Re(j)}catch{}else try{j.setAttribute(o,"")}catch{}},kn=function(o){var j,A;if(Vt)o="<remove></remove>"+o;else{var ie=Ce(o,/^[\r\n\t ]+/);A=ie&&ie[0]}it==="application/xhtml+xml"&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");var de=Be?Be.createHTML(o):o;if(Ot===Je)try{j=new fn().parseFromString(de,it)}catch{}if(!j||!j.documentElement){j=Ut.createDocument(Ot,"template",null);try{j.documentElement.innerHTML=Cn?"":de}catch{}}var _e=j.body||j.documentElement;return o&&A&&_e.insertBefore(ee.createTextNode(A),_e.childNodes[0]||null),Ot===Je?Jn.call(j,re?"html":"body")[0]:re?j.documentElement:_e},vt=function(o){return gn.call(o.ownerDocument||o,o,Xe.SHOW_ELEMENT|Xe.SHOW_COMMENT|Xe.SHOW_TEXT,null,!1)},Xn=function(o){return o instanceof Nt&&(typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof Ct)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function")},yt=function(o){return d(Ke)==="object"?o instanceof Ke:o&&d(o)==="object"&&typeof o.nodeType=="number"&&typeof o.nodeName=="string"},De=function(o,j,A){be[o]&&ne(be[o],function(ie){ie.call(N,j,A,lt)})},nn=function(o){var j;if(De("beforeSanitizeElements",o,null),Xn(o)||S(/[\u0080-\uFFFF]/,o.nodeName))return Re(o),!0;var A=He(o.nodeName);if(De("uponSanitizeElement",o,{tagName:A,allowedTags:ve}),o.hasChildNodes()&&!yt(o.firstElementChild)&&(!yt(o.content)||!yt(o.content.firstElementChild))&&S(/<[/\w]/g,o.innerHTML)&&S(/<[/\w]/g,o.textContent)||A==="select"&&S(/<template/i,o.innerHTML))return Re(o),!0;if(!ve[A]||gt[A]){if(!gt[A]&&rn(A)&&(le.tagNameCheck instanceof RegExp&&S(le.tagNameCheck,A)||le.tagNameCheck instanceof Function&&le.tagNameCheck(A)))return!1;if(St&&!ct[A]){var ie=ot(o)||o.parentNode,de=Gn(o)||o.childNodes;if(de&&ie)for(var _e=de.length-1;_e>=0;--_e)ie.insertBefore(hn(de[_e],!0),pn(o))}return Re(o),!0}return o instanceof Pe&&!Kn(o)?(Re(o),!0):A!=="noscript"&&A!=="noembed"||!S(/<\/no(script|embed)/i,o.innerHTML)?(st&&o.nodeType===3&&(j=o.textContent,j=he(j,Dt," "),j=he(j,$t," "),o.textContent!==j&&(ge(N.removed,{element:o.cloneNode()}),o.textContent=j)),De("afterSanitizeElements",o,null),!1):(Re(o),!0)},On=function(o,j,A){if(Zt&&(j==="id"||j==="name")&&(A in ee||A in Vn))return!1;if(!(Jt&&!Wt[j]&&S(Et,j))){if(!(Gt&&S(Me,j))){if(!ye[j]||Wt[j]){if(!(rn(o)&&(le.tagNameCheck instanceof RegExp&&S(le.tagNameCheck,o)||le.tagNameCheck instanceof Function&&le.tagNameCheck(o))&&(le.attributeNameCheck instanceof RegExp&&S(le.attributeNameCheck,j)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(j))||j==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&S(le.tagNameCheck,A)||le.tagNameCheck instanceof Function&&le.tagNameCheck(A))))return!1}else if(!Kt[j]){if(!S(qt,he(A,mt,""))){if((j!=="src"&&j!=="xlink:href"&&j!=="href"||o==="script"||Fe(A,"data:")!==0||!wn[o])&&!(bn&&!S(zt,he(A,mt,"")))){if(A)return!1}}}}}return!0},rn=function(o){return o.indexOf("-")>0},bt=function(o){var j,A,ie,de;De("beforeSanitizeAttributes",o,null);var _e=o.attributes;if(_e){var we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye};for(de=_e.length;de--;){var _t=j=_e[de],$e=_t.name,te=_t.namespaceURI;if(A=$e==="value"?j.value:g(j.value),ie=He($e),we.attrName=ie,we.attrValue=A,we.keepAttr=!0,we.forceKeepAttr=void 0,De("uponSanitizeAttribute",o,we),A=we.attrValue,!we.forceKeepAttr&&(An($e,o),we.keepAttr))if(S(/\/>/i,A))An($e,o);else{st&&(A=he(A,Dt," "),A=he(A,$t," "));var tt=He(o.nodeName);if(On(tt,ie,A))try{te?o.setAttributeNS(te,$e,A):o.setAttribute($e,A),ae(N.removed)}catch{}}}De("afterSanitizeAttributes",o,null)}},on=function o(j){var A,ie=vt(j);for(De("beforeSanitizeShadowDOM",j,null);A=ie.nextNode();)De("uponSanitizeShadowNode",A,null),nn(A)||(A.content instanceof ce&&o(A.content),bt(A));De("afterSanitizeShadowDOM",j,null)};return N.sanitize=function(o,j){var A,ie,de,_e,we;if((Cn=!o)&&(o="<!-->"),typeof o!="string"&&!yt(o)){if(typeof o.toString!="function")throw B("toString is not a function");if(typeof(o=o.toString())!="string")throw B("dirty is not a string, aborting")}if(!N.isSupported){if(d(k.toStaticHTML)==="object"||typeof k.toStaticHTML=="function"){if(typeof o=="string")return k.toStaticHTML(o);if(yt(o))return k.toStaticHTML(o.outerHTML)}return o}if(Yt||Qt(j),N.removed=[],typeof o=="string"&&(et=!1),et){if(o.nodeName){var _t=He(o.nodeName);if(!ve[_t]||gt[_t])throw B("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof Ke)(ie=(A=kn("<!---->")).ownerDocument.importNode(o,!0)).nodeType===1&&ie.nodeName==="BODY"||ie.nodeName==="HTML"?A=ie:A.appendChild(ie);else{if(!Qe&&!st&&!re&&o.indexOf("<")===-1)return Be&&at?Be.createHTML(o):o;if(!(A=kn(o)))return Qe?null:at?mn:""}A&&Vt&&Re(A.firstChild);for(var $e=vt(et?o:A);de=$e.nextNode();)de.nodeType===3&&de===_e||nn(de)||(de.content instanceof ce&&on(de.content),bt(de),_e=de);if(_e=null,et)return o;if(Qe){if(We)for(we=vn.call(A.ownerDocument);A.firstChild;)we.appendChild(A.firstChild);else we=A;return ye.shadowroot&&(we=Rt.call(Y,we,!0)),we}var te=re?A.outerHTML:A.innerHTML;return re&&ve["!doctype"]&&A.ownerDocument&&A.ownerDocument.doctype&&A.ownerDocument.doctype.name&&S(un,A.ownerDocument.doctype.name)&&(te="<!DOCTYPE "+A.ownerDocument.doctype.name+`>
`+te),st&&(te=he(te,Dt," "),te=he(te,$t," ")),Be&&at?Be.createHTML(te):te},N.setConfig=function(o){Qt(o),Yt=!0},N.clearConfig=function(){lt=null,Yt=!1},N.isValidAttribute=function(o,j,A){lt||Qt({});var ie=He(o),de=He(j);return On(ie,de,A)},N.addHook=function(o,j){typeof j=="function"&&(be[o]=be[o]||[],ge(be[o],j))},N.removeHook=function(o){if(be[o])return ae(be[o])},N.removeHooks=function(o){be[o]&&(be[o]=[])},N.removeAllHooks=function(){be={}},N}return ft()}()},729:I=>{var d=Object.prototype.hasOwnProperty,y="~";function _(){}function v(p,x,m){this.fn=p,this.context=x,this.once=m||!1}function E(p,x,m,$,L){if(typeof m!="function")throw new TypeError("The listener must be a function");var M=new v(m,$||p,L),V=y?y+x:x;return p._events[V]?p._events[V].fn?p._events[V]=[p._events[V],M]:p._events[V].push(M):(p._events[V]=M,p._eventsCount++),p}function G(p,x){--p._eventsCount==0?p._events=new _:delete p._events[x]}function b(){this._events=new _,this._eventsCount=0}Object.create&&(_.prototype=Object.create(null),new _().__proto__||(y=!1)),b.prototype.eventNames=function(){var p,x,m=[];if(this._eventsCount===0)return m;for(x in p=this._events)d.call(p,x)&&m.push(y?x.slice(1):x);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(p)):m},b.prototype.listeners=function(p){var x=y?y+p:p,m=this._events[x];if(!m)return[];if(m.fn)return[m.fn];for(var $=0,L=m.length,M=new Array(L);$<L;$++)M[$]=m[$].fn;return M},b.prototype.listenerCount=function(p){var x=y?y+p:p,m=this._events[x];return m?m.fn?1:m.length:0},b.prototype.emit=function(p,x,m,$,L,M){var V=y?y+p:p;if(!this._events[V])return!1;var F,z,s=this._events[V],l=arguments.length;if(s.fn){switch(s.once&&this.removeListener(p,s.fn,void 0,!0),l){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,x),!0;case 3:return s.fn.call(s.context,x,m),!0;case 4:return s.fn.call(s.context,x,m,$),!0;case 5:return s.fn.call(s.context,x,m,$,L),!0;case 6:return s.fn.call(s.context,x,m,$,L,M),!0}for(z=1,F=new Array(l-1);z<l;z++)F[z-1]=arguments[z];s.fn.apply(s.context,F)}else{var C,T=s.length;for(z=0;z<T;z++)switch(s[z].once&&this.removeListener(p,s[z].fn,void 0,!0),l){case 1:s[z].fn.call(s[z].context);break;case 2:s[z].fn.call(s[z].context,x);break;case 3:s[z].fn.call(s[z].context,x,m);break;case 4:s[z].fn.call(s[z].context,x,m,$);break;default:if(!F)for(C=1,F=new Array(l-1);C<l;C++)F[C-1]=arguments[C];s[z].fn.apply(s[z].context,F)}}return!0},b.prototype.on=function(p,x,m){return E(this,p,x,m,!1)},b.prototype.once=function(p,x,m){return E(this,p,x,m,!0)},b.prototype.removeListener=function(p,x,m,$){var L=y?y+p:p;if(!this._events[L])return this;if(!x)return G(this,L),this;var M=this._events[L];if(M.fn)M.fn!==x||$&&!M.once||m&&M.context!==m||G(this,L);else{for(var V=0,F=[],z=M.length;V<z;V++)(M[V].fn!==x||$&&!M[V].once||m&&M[V].context!==m)&&F.push(M[V]);F.length?this._events[L]=F.length===1?F[0]:F:G(this,L)}return this},b.prototype.removeAllListeners=function(p){var x;return p?(x=y?y+p:p,this._events[x]&&G(this,x)):(this._events=new _,this._eventsCount=0),this},b.prototype.off=b.prototype.removeListener,b.prototype.addListener=b.prototype.on,b.prefixed=y,b.EventEmitter=b,I.exports=b},717:I=>{typeof Object.create=="function"?I.exports=function(d,y){d.super_=y,d.prototype=Object.create(y.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}})}:I.exports=function(d,y){d.super_=y;var _=function(){};_.prototype=y.prototype,d.prototype=new _,d.prototype.constructor=d}},824:I=>{var d=1e3,y=60*d,_=60*y,v=24*_,E=7*v,G=365.25*v;function b(p,x,m,$){var L=x>=1.5*m;return Math.round(p/m)+" "+$+(L?"s":"")}I.exports=function(p,x){x=x||{};var m=typeof p;if(m==="string"&&p.length>0)return function($){if(!(($=String($)).length>100)){var L=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(L){var M=parseFloat(L[1]);switch((L[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return M*G;case"weeks":case"week":case"w":return M*E;case"days":case"day":case"d":return M*v;case"hours":case"hour":case"hrs":case"hr":case"h":return M*_;case"minutes":case"minute":case"mins":case"min":case"m":return M*y;case"seconds":case"second":case"secs":case"sec":case"s":return M*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return M;default:return}}}}(p);if(m==="number"&&isFinite(p))return x.long?function($){var L=Math.abs($);return L>=v?b($,L,v,"day"):L>=_?b($,L,_,"hour"):L>=y?b($,L,y,"minute"):L>=d?b($,L,d,"second"):$+" ms"}(p):function($){var L=Math.abs($);return L>=v?Math.round($/v)+"d":L>=_?Math.round($/_)+"h":L>=y?Math.round($/y)+"m":L>=d?Math.round($/d)+"s":$+"ms"}(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))}},520:(I,d,y)=>{var _=y(155),v=_.platform==="win32",E=y(539);function G(s,l){for(var C=[],T=0;T<s.length;T++){var K=s[T];K&&K!=="."&&(K===".."?C.length&&C[C.length-1]!==".."?C.pop():l&&C.push(".."):C.push(K))}return C}function b(s){for(var l=s.length-1,C=0;C<=l&&!s[C];C++);for(var T=l;T>=0&&!s[T];T--);return C===0&&T===l?s:C>T?[]:s.slice(C,T+1)}var p=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,x=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,m={};function $(s){var l=p.exec(s),C=(l[1]||"")+(l[2]||""),T=l[3]||"",K=x.exec(T);return[C,K[1],K[2],K[3]]}function L(s){var l=p.exec(s),C=l[1]||"",T=!!C&&C[1]!==":";return{device:C,isUnc:T,isAbsolute:T||!!l[2],tail:l[3]}}function M(s){return"\\\\"+s.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}m.resolve=function(){for(var s="",l="",C=!1,T=arguments.length-1;T>=-1;T--){var K;if(T>=0?K=arguments[T]:s?(K=_.env["="+s])&&K.substr(0,3).toLowerCase()===s.toLowerCase()+"\\"||(K=s+"\\"):K=_.cwd(),!E.isString(K))throw new TypeError("Arguments to path.resolve must be strings");if(K){var ne=L(K),ae=ne.device,ge=ne.isUnc,xe=ne.isAbsolute,Ce=ne.tail;if((!ae||!s||ae.toLowerCase()===s.toLowerCase())&&(s||(s=ae),C||(l=Ce+"\\"+l,C=xe),s&&C))break}}return ge&&(s=M(s)),s+(C?"\\":"")+(l=G(l.split(/[\\\/]+/),!C).join("\\"))||"."},m.normalize=function(s){var l=L(s),C=l.device,T=l.isUnc,K=l.isAbsolute,ne=l.tail,ae=/[\\\/]$/.test(ne);return(ne=G(ne.split(/[\\\/]+/),!K).join("\\"))||K||(ne="."),ne&&ae&&(ne+="\\"),T&&(C=M(C)),C+(K?"\\":"")+ne},m.isAbsolute=function(s){return L(s).isAbsolute},m.join=function(){for(var s=[],l=0;l<arguments.length;l++){var C=arguments[l];if(!E.isString(C))throw new TypeError("Arguments to path.join must be strings");C&&s.push(C)}var T=s.join("\\");return/^[\\\/]{2}[^\\\/]/.test(s[0])||(T=T.replace(/^[\\\/]{2,}/,"\\")),m.normalize(T)},m.relative=function(s,l){s=m.resolve(s),l=m.resolve(l);for(var C=s.toLowerCase(),T=l.toLowerCase(),K=b(l.split("\\")),ne=b(C.split("\\")),ae=b(T.split("\\")),ge=Math.min(ne.length,ae.length),xe=ge,Ce=0;Ce<ge;Ce++)if(ne[Ce]!==ae[Ce]){xe=Ce;break}if(xe==0)return l;var he=[];for(Ce=xe;Ce<ne.length;Ce++)he.push("..");return(he=he.concat(K.slice(xe))).join("\\")},m._makeLong=function(s){if(!E.isString(s))return s;if(!s)return"";var l=m.resolve(s);return/^[a-zA-Z]\:\\/.test(l)?"\\\\?\\"+l:/^\\\\[^?.]/.test(l)?"\\\\?\\UNC\\"+l.substring(2):s},m.dirname=function(s){var l=$(s),C=l[0],T=l[1];return C||T?(T&&(T=T.substr(0,T.length-1)),C+T):"."},m.basename=function(s,l){var C=$(s)[2];return l&&C.substr(-1*l.length)===l&&(C=C.substr(0,C.length-l.length)),C},m.extname=function(s){return $(s)[3]},m.format=function(s){if(!E.isObject(s))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof s);var l=s.root||"";if(!E.isString(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof s.root);var C=s.dir,T=s.base||"";return C?C[C.length-1]===m.sep?C+T:C+m.sep+T:T},m.parse=function(s){if(!E.isString(s))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof s);var l=$(s);if(!l||l.length!==4)throw new TypeError("Invalid path '"+s+"'");return{root:l[0],dir:l[0]+l[1].slice(0,-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},m.sep="\\",m.delimiter=";";var V=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,F={};function z(s){return V.exec(s).slice(1)}F.resolve=function(){for(var s="",l=!1,C=arguments.length-1;C>=-1&&!l;C--){var T=C>=0?arguments[C]:_.cwd();if(!E.isString(T))throw new TypeError("Arguments to path.resolve must be strings");T&&(s=T+"/"+s,l=T[0]==="/")}return(l?"/":"")+(s=G(s.split("/"),!l).join("/"))||"."},F.normalize=function(s){var l=F.isAbsolute(s),C=s&&s[s.length-1]==="/";return(s=G(s.split("/"),!l).join("/"))||l||(s="."),s&&C&&(s+="/"),(l?"/":"")+s},F.isAbsolute=function(s){return s.charAt(0)==="/"},F.join=function(){for(var s="",l=0;l<arguments.length;l++){var C=arguments[l];if(!E.isString(C))throw new TypeError("Arguments to path.join must be strings");C&&(s+=s?"/"+C:C)}return F.normalize(s)},F.relative=function(s,l){s=F.resolve(s).substr(1),l=F.resolve(l).substr(1);for(var C=b(s.split("/")),T=b(l.split("/")),K=Math.min(C.length,T.length),ne=K,ae=0;ae<K;ae++)if(C[ae]!==T[ae]){ne=ae;break}var ge=[];for(ae=ne;ae<C.length;ae++)ge.push("..");return(ge=ge.concat(T.slice(ne))).join("/")},F._makeLong=function(s){return s},F.dirname=function(s){var l=z(s),C=l[0],T=l[1];return C||T?(T&&(T=T.substr(0,T.length-1)),C+T):"."},F.basename=function(s,l){var C=z(s)[2];return l&&C.substr(-1*l.length)===l&&(C=C.substr(0,C.length-l.length)),C},F.extname=function(s){return z(s)[3]},F.format=function(s){if(!E.isObject(s))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof s);var l=s.root||"";if(!E.isString(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof s.root);return(s.dir?s.dir+F.sep:"")+(s.base||"")},F.parse=function(s){if(!E.isString(s))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof s);var l=z(s);if(!l||l.length!==4)throw new TypeError("Invalid path '"+s+"'");return l[1]=l[1]||"",l[2]=l[2]||"",l[3]=l[3]||"",{root:l[0],dir:l[0]+l[1].slice(0,-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},F.sep="/",F.delimiter=":",I.exports=v?m:F,I.exports.posix=F,I.exports.win32=m},155:I=>{var d,y,_=I.exports={};function v(){throw new Error("setTimeout has not been defined")}function E(){throw new Error("clearTimeout has not been defined")}function G(F){if(d===setTimeout)return setTimeout(F,0);if((d===v||!d)&&setTimeout)return d=setTimeout,setTimeout(F,0);try{return d(F,0)}catch{try{return d.call(null,F,0)}catch{return d.call(this,F,0)}}}(function(){try{d=typeof setTimeout=="function"?setTimeout:v}catch{d=v}try{y=typeof clearTimeout=="function"?clearTimeout:E}catch{y=E}})();var b,p=[],x=!1,m=-1;function $(){x&&b&&(x=!1,b.length?p=b.concat(p):m=-1,p.length&&L())}function L(){if(!x){var F=G($);x=!0;for(var z=p.length;z;){for(b=p,p=[];++m<z;)b&&b[m].run();m=-1,z=p.length}b=null,x=!1,function(s){if(y===clearTimeout)return clearTimeout(s);if((y===E||!y)&&clearTimeout)return y=clearTimeout,clearTimeout(s);try{y(s)}catch{try{return y.call(null,s)}catch{return y.call(this,s)}}}(F)}}function M(F,z){this.fun=F,this.array=z}function V(){}_.nextTick=function(F){var z=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)z[s-1]=arguments[s];p.push(new M(F,z)),p.length!==1||x||G(L)},M.prototype.run=function(){this.fun.apply(null,this.array)},_.title="browser",_.browser=!0,_.env={},_.argv=[],_.version="",_.versions={},_.on=V,_.addListener=V,_.once=V,_.off=V,_.removeListener=V,_.removeAllListeners=V,_.emit=V,_.prependListener=V,_.prependOnceListener=V,_.listeners=function(F){return[]},_.binding=function(F){throw new Error("process.binding is not supported")},_.cwd=function(){return"/"},_.chdir=function(F){throw new Error("process.chdir is not supported")},_.umask=function(){return 0}},384:I=>{I.exports=function(d){return d&&typeof d=="object"&&typeof d.copy=="function"&&typeof d.fill=="function"&&typeof d.readUInt8=="function"}},539:(I,d,y)=>{var _=y(155),v=/%[sdj%]/g;d.format=function(g){if(!s(g)){for(var S=[],B=0;B<arguments.length;B++)S.push(b(arguments[B]));return S.join(" ")}B=1;for(var oe=arguments,Se=oe.length,H=String(g).replace(v,function(ue){if(ue==="%%")return"%";if(B>=Se)return ue;switch(ue){case"%s":return String(oe[B++]);case"%d":return Number(oe[B++]);case"%j":try{return JSON.stringify(oe[B++])}catch{return"[Circular]"}default:return ue}}),X=oe[B];B<Se;X=oe[++B])F(X)||!T(X)?H+=" "+X:H+=" "+b(X);return H},d.deprecate=function(g,S){if(l(y.g.process))return function(){return d.deprecate(g,S).apply(this,arguments)};if(_.noDeprecation===!0)return g;var B=!1;return function(){if(!B){if(_.throwDeprecation)throw new Error(S);_.traceDeprecation?console.trace(S):console.error(S),B=!0}return g.apply(this,arguments)}};var E,G={};function b(g,S){var B={seen:[],stylize:x};return arguments.length>=3&&(B.depth=arguments[2]),arguments.length>=4&&(B.colors=arguments[3]),V(S)?B.showHidden=S:S&&d._extend(B,S),l(B.showHidden)&&(B.showHidden=!1),l(B.depth)&&(B.depth=2),l(B.colors)&&(B.colors=!1),l(B.customInspect)&&(B.customInspect=!0),B.colors&&(B.stylize=p),m(B,g,B.depth)}function p(g,S){var B=b.styles[S];return B?"\x1B["+b.colors[B][0]+"m"+g+"\x1B["+b.colors[B][1]+"m":g}function x(g,S){return g}function m(g,S,B){if(g.customInspect&&S&&ae(S.inspect)&&S.inspect!==d.inspect&&(!S.constructor||S.constructor.prototype!==S)){var oe=S.inspect(B,g);return s(oe)||(oe=m(g,oe,B)),oe}var Se=function(pe,fe){if(l(fe))return pe.stylize("undefined","undefined");if(s(fe)){var ke="'"+JSON.stringify(fe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return pe.stylize(ke,"string")}if(z(fe))return pe.stylize(""+fe,"number");if(V(fe))return pe.stylize(""+fe,"boolean");if(F(fe))return pe.stylize("null","null")}(g,S);if(Se)return Se;var H=Object.keys(S),X=function(pe){var fe={};return pe.forEach(function(ke,Oe){fe[ke]=!0}),fe}(H);if(g.showHidden&&(H=Object.getOwnPropertyNames(S)),ne(S)&&(H.indexOf("message")>=0||H.indexOf("description")>=0))return $(S);if(H.length===0){if(ae(S)){var ue=S.name?": "+S.name:"";return g.stylize("[Function"+ue+"]","special")}if(C(S))return g.stylize(RegExp.prototype.toString.call(S),"regexp");if(K(S))return g.stylize(Date.prototype.toString.call(S),"date");if(ne(S))return $(S)}var je,Ae="",qe=!1,nt=["{","}"];return M(S)&&(qe=!0,nt=["[","]"]),ae(S)&&(Ae=" [Function"+(S.name?": "+S.name:"")+"]"),C(S)&&(Ae=" "+RegExp.prototype.toString.call(S)),K(S)&&(Ae=" "+Date.prototype.toUTCString.call(S)),ne(S)&&(Ae=" "+$(S)),H.length!==0||qe&&S.length!=0?B<0?C(S)?g.stylize(RegExp.prototype.toString.call(S),"regexp"):g.stylize("[Object]","special"):(g.seen.push(S),je=qe?function(pe,fe,ke,Oe,Te){for(var Le=[],Ue=0,Lt=fe.length;Ue<Lt;++Ue)Fe(fe,String(Ue))?Le.push(L(pe,fe,ke,Oe,String(Ue),!0)):Le.push("");return Te.forEach(function(xt){xt.match(/^\d+$/)||Le.push(L(pe,fe,ke,Oe,xt,!0))}),Le}(g,S,B,X,H):H.map(function(pe){return L(g,S,B,X,pe,qe)}),g.seen.pop(),function(pe,fe,ke){return pe.reduce(function(Oe,Te){return Te.indexOf(`
`)>=0,Oe+Te.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?ke[0]+(fe===""?"":fe+`
 `)+" "+pe.join(`,
  `)+" "+ke[1]:ke[0]+fe+" "+pe.join(", ")+" "+ke[1]}(je,Ae,nt)):nt[0]+Ae+nt[1]}function $(g){return"["+Error.prototype.toString.call(g)+"]"}function L(g,S,B,oe,Se,H){var X,ue,je;if((je=Object.getOwnPropertyDescriptor(S,Se)||{value:S[Se]}).get?ue=je.set?g.stylize("[Getter/Setter]","special"):g.stylize("[Getter]","special"):je.set&&(ue=g.stylize("[Setter]","special")),Fe(oe,Se)||(X="["+Se+"]"),ue||(g.seen.indexOf(je.value)<0?(ue=F(B)?m(g,je.value,null):m(g,je.value,B-1)).indexOf(`
`)>-1&&(ue=H?ue.split(`
`).map(function(Ae){return"  "+Ae}).join(`
`).substr(2):`
`+ue.split(`
`).map(function(Ae){return"   "+Ae}).join(`
`)):ue=g.stylize("[Circular]","special")),l(X)){if(H&&Se.match(/^\d+$/))return ue;(X=JSON.stringify(""+Se)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=g.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=g.stylize(X,"string"))}return X+": "+ue}function M(g){return Array.isArray(g)}function V(g){return typeof g=="boolean"}function F(g){return g===null}function z(g){return typeof g=="number"}function s(g){return typeof g=="string"}function l(g){return g===void 0}function C(g){return T(g)&&ge(g)==="[object RegExp]"}function T(g){return typeof g=="object"&&g!==null}function K(g){return T(g)&&ge(g)==="[object Date]"}function ne(g){return T(g)&&(ge(g)==="[object Error]"||g instanceof Error)}function ae(g){return typeof g=="function"}function ge(g){return Object.prototype.toString.call(g)}function xe(g){return g<10?"0"+g.toString(10):g.toString(10)}d.debuglog=function(g){if(l(E)&&(E=_.env.NODE_DEBUG||""),g=g.toUpperCase(),!G[g])if(new RegExp("\\b"+g+"\\b","i").test(E)){var S=_.pid;G[g]=function(){var B=d.format.apply(d,arguments);console.error("%s %d: %s",g,S,B)}}else G[g]=function(){};return G[g]},d.inspect=b,b.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},b.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},d.isArray=M,d.isBoolean=V,d.isNull=F,d.isNullOrUndefined=function(g){return g==null},d.isNumber=z,d.isString=s,d.isSymbol=function(g){return typeof g=="symbol"},d.isUndefined=l,d.isRegExp=C,d.isObject=T,d.isDate=K,d.isError=ne,d.isFunction=ae,d.isPrimitive=function(g){return g===null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||typeof g=="symbol"||g===void 0},d.isBuffer=y(384);var Ce=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function he(){var g=new Date,S=[xe(g.getHours()),xe(g.getMinutes()),xe(g.getSeconds())].join(":");return[g.getDate(),Ce[g.getMonth()],S].join(" ")}function Fe(g,S){return Object.prototype.hasOwnProperty.call(g,S)}d.log=function(){console.log("%s - %s",he(),d.format.apply(d,arguments))},d.inherits=y(717),d._extend=function(g,S){if(!S||!T(S))return g;for(var B=Object.keys(S),oe=B.length;oe--;)g[B[oe]]=S[B[oe]];return g}}},q={};function P(I){var d=q[I];if(d!==void 0)return d.exports;var y=q[I]={exports:{}};return O[I].call(y.exports,y,y.exports,P),y.exports}P.n=I=>{var d=I&&I.__esModule?()=>I.default:()=>I;return P.d(d,{a:d}),d},P.d=(I,d)=>{for(var y in d)P.o(d,y)&&!P.o(I,y)&&Object.defineProperty(I,y,{enumerable:!0,get:d[y]})},P.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),P.o=(I,d)=>Object.prototype.hasOwnProperty.call(I,d),P.r=I=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})};var J={};return(()=>{P.r(J),P.d(J,{LSPluginUser:()=>fr,setupPluginUserInstance:()=>Wr});var I=P(520);P(856);const d=function(){this.__data__=[],this.size=0},y=function(t,e){return t===e||t!=t&&e!=e},_=function(t,e){for(var n=t.length;n--;)if(y(t[n][0],e))return n;return-1};var v=Array.prototype.splice;const E=function(t){var e=this.__data__,n=_(e,t);return!(n<0)&&(n==e.length-1?e.pop():v.call(e,n,1),--this.size,!0)},G=function(t){var e=this.__data__,n=_(e,t);return n<0?void 0:e[n][1]},b=function(t){return _(this.__data__,t)>-1},p=function(t,e){var n=this.__data__,r=_(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function x(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}x.prototype.clear=d,x.prototype.delete=E,x.prototype.get=G,x.prototype.has=b,x.prototype.set=p;const m=x,$=function(){this.__data__=new m,this.size=0},L=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},M=function(t){return this.__data__.get(t)},V=function(t){return this.__data__.has(t)},F=typeof Nn=="object"&&Nn&&Nn.Object===Object&&Nn;var z=typeof self=="object"&&self&&self.Object===Object&&self;const s=F||z||Function("return this")(),l=s.Symbol;var C=Object.prototype,T=C.hasOwnProperty,K=C.toString,ne=l?l.toStringTag:void 0;const ae=function(t){var e=T.call(t,ne),n=t[ne];try{t[ne]=void 0;var r=!0}catch{}var i=K.call(t);return r&&(e?t[ne]=n:delete t[ne]),i};var ge=Object.prototype.toString;const xe=function(t){return ge.call(t)};var Ce=l?l.toStringTag:void 0;const he=function(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Ce&&Ce in Object(t)?ae(t):xe(t)},Fe=function(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")},g=function(t){if(!Fe(t))return!1;var e=he(t);return e=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]"},S=s["__core-js_shared__"];var B,oe=(B=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";const Se=function(t){return!!oe&&oe in t};var H=Function.prototype.toString;const X=function(t){if(t!=null){try{return H.call(t)}catch{}try{return t+""}catch{}}return""};var ue=/^\[object .+?Constructor\]$/,je=Function.prototype,Ae=Object.prototype,qe=je.toString,nt=Ae.hasOwnProperty,pe=RegExp("^"+qe.call(nt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const fe=function(t){return!(!Fe(t)||Se(t))&&(g(t)?pe:ue).test(X(t))},ke=function(t,e){return t?.[e]},Oe=function(t,e){var n=ke(t,e);return fe(n)?n:void 0},Te=Oe(s,"Map"),Le=Oe(Object,"create"),Ue=function(){this.__data__=Le?Le(null):{},this.size=0},Lt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var xt=Object.prototype.hasOwnProperty;const $n=function(t){var e=this.__data__;if(Le){var n=e[t];return n==="__lodash_hash_undefined__"?void 0:n}return xt.call(e,t)?e[t]:void 0};var zn=Object.prototype.hasOwnProperty;const qn=function(t){var e=this.__data__;return Le?e[t]!==void 0:zn.call(e,t)},Bn=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Le&&e===void 0?"__lodash_hash_undefined__":e,this};function rt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}rt.prototype.clear=Ue,rt.prototype.delete=Lt,rt.prototype.get=$n,rt.prototype.has=qn,rt.prototype.set=Bn;const un=rt,Hn=function(){this.size=0,this.__data__={hash:new un,map:new(Te||m),string:new un}},Wn=function(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null},ft=function(t,e){var n=t.__data__;return Wn(e)?n[typeof e=="string"?"string":"hash"]:n.map},k=function(t){var e=ft(this,t).delete(t);return this.size-=e?1:0,e},N=function(t){return ft(this,t).get(t)},Y=function(t){return ft(this,t).has(t)},ee=function(t,e){var n=ft(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function ce(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ce.prototype.clear=Hn,ce.prototype.delete=k,ce.prototype.get=N,ce.prototype.has=Y,ce.prototype.set=ee;const Ne=ce,Ke=function(t,e){var n=this.__data__;if(n instanceof m){var r=n.__data__;if(!Te||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ne(r)}return n.set(t,e),this.size=n.size,this};function Pe(t){var e=this.__data__=new m(t);this.size=e.size}Pe.prototype.clear=$,Pe.prototype.delete=L,Pe.prototype.get=M,Pe.prototype.has=V,Pe.prototype.set=Ke;const Xe=Pe,dt=function(){try{var t=Oe(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Ct=function(t,e,n){e=="__proto__"&&dt?dt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Nt=function(t,e,n){(n!==void 0&&!y(t[e],n)||n===void 0&&!(e in t))&&Ct(t,e,n)},fn=function(t){return function(e,n,r){for(var i=-1,a=Object(e),u=r(e),h=u.length;h--;){var w=u[t?h:++i];if(n(a[w],w,a)===!1)break}return e}}();var dn=f&&!f.nodeType&&f,ht=dn&&!0&&c&&!c.nodeType&&c,hn=ht&&ht.exports===dn?s.Buffer:void 0,pn=hn?hn.allocUnsafe:void 0;const Gn=function(t,e){if(e)return t.slice();var n=t.length,r=pn?pn(n):new t.constructor(n);return t.copy(r),r},ot=s.Uint8Array,Pt=function(t){var e=new t.constructor(t.byteLength);return new ot(e).set(new ot(t)),e},Be=function(t,e){var n=e?Pt(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},mn=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e};var pt=Object.create;const Ut=function(){function t(){}return function(e){if(!Fe(e))return{};if(pt)return pt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),gn=function(t,e){return function(n){return t(e(n))}},vn=gn(Object.getPrototypeOf,Object);var Jn=Object.prototype;const Rt=function(t){var e=t&&t.constructor;return t===(typeof e=="function"&&e.prototype||Jn)},yn=function(t){return typeof t.constructor!="function"||Rt(t)?{}:Ut(vn(t))},be=function(t){return t!=null&&typeof t=="object"},it=function(t){return be(t)&&he(t)=="[object Arguments]"};var He=Object.prototype,Dt=He.hasOwnProperty,$t=He.propertyIsEnumerable;const Et=it(function(){return arguments}())?it:function(t){return be(t)&&Dt.call(t,"callee")&&!$t.call(t,"callee")},Me=Array.isArray,zt=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991},mt=function(t){return t!=null&&zt(t.length)&&!g(t)},qt=function(t){return be(t)&&mt(t)},ve=function(){return!1};var Bt=f&&!f.nodeType&&f,ye=Bt&&!0&&c&&!c.nodeType&&c,Ht=ye&&ye.exports===Bt?s.Buffer:void 0;const le=(Ht?Ht.isBuffer:void 0)||ve;var gt=Function.prototype,Wt=Object.prototype,Gt=gt.toString,Jt=Wt.hasOwnProperty,bn=Gt.call(Object);const st=function(t){if(!be(t)||he(t)!="[object Object]")return!1;var e=vn(t);if(e===null)return!0;var n=Jt.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Gt.call(n)==bn};var re={};re["[object Float32Array]"]=re["[object Float64Array]"]=re["[object Int8Array]"]=re["[object Int16Array]"]=re["[object Int32Array]"]=re["[object Uint8Array]"]=re["[object Uint8ClampedArray]"]=re["[object Uint16Array]"]=re["[object Uint32Array]"]=!0,re["[object Arguments]"]=re["[object Array]"]=re["[object ArrayBuffer]"]=re["[object Boolean]"]=re["[object DataView]"]=re["[object Date]"]=re["[object Error]"]=re["[object Function]"]=re["[object Map]"]=re["[object Number]"]=re["[object Object]"]=re["[object RegExp]"]=re["[object Set]"]=re["[object String]"]=re["[object WeakMap]"]=!1;const Yt=function(t){return be(t)&&zt(t.length)&&!!re[he(t)]},Vt=function(t){return function(e){return t(e)}};var Qe=f&&!f.nodeType&&f,We=Qe&&!0&&c&&!c.nodeType&&c,at=We&&We.exports===Qe&&F.process,Zt=function(){try{var t=We&&We.require&&We.require("util").types;return t||at&&at.binding&&at.binding("util")}catch{}}(),St=Zt&&Zt.isTypedArray;const et=St?Vt(St):Yt,Ge=function(t,e){if((e!=="constructor"||typeof t[e]!="function")&&e!="__proto__")return t[e]};var ct=Object.prototype.hasOwnProperty;const _n=function(t,e,n){var r=t[e];ct.call(t,e)&&y(r,n)&&(n!==void 0||e in t)||Ct(t,e,n)},wn=function(t,e,n,r){var i=!n;n||(n={});for(var a=-1,u=e.length;++a<u;){var h=e[a],w=r?r(n[h],t[h],h,n,t):void 0;w===void 0&&(w=t[h]),i?Ct(n,h,w):_n(n,h,w)}return n},xn=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r};var Kt=/^(?:0|[1-9]\d*)$/;const At=function(t,e){var n=typeof t;return!!(e=e??9007199254740991)&&(n=="number"||n!="symbol"&&Kt.test(t))&&t>-1&&t%1==0&&t<e};var Xt=Object.prototype.hasOwnProperty;const kt=function(t,e){var n=Me(t),r=!n&&Et(t),i=!n&&!r&&le(t),a=!n&&!r&&!i&&et(t),u=n||r||i||a,h=u?xn(t.length,String):[],w=h.length;for(var U in t)!e&&!Xt.call(t,U)||u&&(U=="length"||i&&(U=="offset"||U=="parent")||a&&(U=="buffer"||U=="byteLength"||U=="byteOffset")||At(U,w))||h.push(U);return h},Je=function(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e};var Ot=Object.prototype.hasOwnProperty;const Cn=function(t){if(!Fe(t))return Je(t);var e=Rt(t),n=[];for(var r in t)(r!="constructor"||!e&&Ot.call(t,r))&&n.push(r);return n},En=function(t){return mt(t)?kt(t,!0):Cn(t)},Yn=function(t){return wn(t,En(t))},lt=function(t,e,n,r,i,a,u){var h=Ge(t,n),w=Ge(e,n),U=u.get(w);if(U)Nt(t,n,U);else{var R=a?a(h,w,n+"",t,e,u):void 0,D=R===void 0;if(D){var W=Me(w),Q=!W&&le(w),Z=!W&&!Q&&et(w);R=w,W||Q||Z?Me(h)?R=h:qt(h)?R=mn(h):Q?(D=!1,R=Gn(w,!0)):Z?(D=!1,R=Be(w,!0)):R=[]:st(w)||Et(w)?(R=h,Et(h)?R=Yn(h):Fe(h)&&!g(h)||(R=yn(w))):D=!1}D&&(u.set(w,R),i(R,w,r,a,u),u.delete(w)),Nt(t,n,R)}},Vn=function t(e,n,r,i,a){e!==n&&fn(n,function(u,h){if(a||(a=new Xe),Fe(u))lt(e,n,h,r,t,i,a);else{var w=i?i(Ge(e,h),u,h+"",e,n,a):void 0;w===void 0&&(w=u),Nt(e,h,w)}},En)},jt=function(t){return t},Qt=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)};var en=Math.max;const Sn=function(t,e,n){return e=en(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,a=en(r.length-e,0),u=Array(a);++i<a;)u[i]=r[e+i];i=-1;for(var h=Array(e+1);++i<e;)h[i]=r[i];return h[e]=n(u),Qt(t,this,h)}},Zn=function(t){return function(){return t}},It=dt?function(t,e){return dt(t,"toString",{configurable:!0,enumerable:!1,value:Zn(e),writable:!0})}:jt;var tn=Date.now;const Kn=function(t){var e=0,n=0;return function(){var r=tn(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(It),Re=function(t,e){return Kn(Sn(t,e,jt),t+"")},An=function(t,e,n){if(!Fe(n))return!1;var r=typeof e;return!!(r=="number"?mt(n)&&At(e,n.length):r=="string"&&e in n)&&y(n[e],t)},kn=function(t){return Re(function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,u=i>2?n[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,u&&An(n[0],n[1],u)&&(a=i<3?void 0:a,i=1),e=Object(e);++r<i;){var h=n[r];h&&t(e,h,r,a)}return e})}(function(t,e,n){Vn(t,e,n)});var vt=function(){return vt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},vt.apply(this,arguments)};function Xn(t){return t.toLowerCase()}var yt=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],De=/[^A-Z0-9]+/gi;function nn(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce(function(r,i){return r.replace(i,n)},t)}function On(t,e){return e===void 0&&(e={}),function(n,r){r===void 0&&(r={});for(var i=r.splitRegexp,a=i===void 0?yt:i,u=r.stripRegexp,h=u===void 0?De:u,w=r.transform,U=w===void 0?Xn:w,R=r.delimiter,D=R===void 0?" ":R,W=nn(nn(n,a,"$1\0$2"),h,"\0"),Q=0,Z=W.length;W.charAt(Q)==="\0";)Q++;for(;W.charAt(Z-1)==="\0";)Z--;return W.slice(Q,Z).split("\0").map(U).join(D)}(t,vt({delimiter:"."},e))}var rn=P(729),bt=P.n(rn);function on(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const o=navigator.platform.toLowerCase()==="win32"?I.win32:I.posix,j=function(t,e){return e===void 0&&(e={}),On(t,vt({delimiter:"_"},e))},A=kn;class ie extends bt(){constructor(e,n){super(),on(this,"_tag",void 0),on(this,"_opts",void 0),on(this,"_logs",[]),this._tag=e,this._opts=n}write(e,n,r){var i;n!=null&&n.length&&n[n.length-1]===!0&&(r=!0,n.pop());const a=n.reduce((h,w)=>(w&&w instanceof Error?h+=`${w.message} ${w.stack}`:h+=w.toString(),h),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var u;this._logs.push([e,a]),(r||(i=this._opts)!==null&&i!==void 0&&i.console)&&((u=console)===null||u===void 0||u[e==="ERROR"?"error":"debug"](`${e}: ${a}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function de(t,...e){try{const n=new URL(t);if(!n.origin)throw new Error(null);const r=o.join(t.substr(n.origin.length),...e);return n.origin+r}catch{return o.join(t,...e)}}function _e(t,e){let n,r,i=!1;const a=h=>w=>{t&&clearTimeout(t),h(w),i=!0},u=new Promise((h,w)=>{n=a(h),r=a(w),t&&(t=setTimeout(()=>r(new Error(`[deferred timeout] ${e}`)),t))});return{created:Date.now(),setTag:h=>e=h,resolve:n,reject:r,promise:u,get settled(){return i}}}const we=new Map;window.__injectedUIEffects=we;var _t=P(227),$e=P.n(_t);function te(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const tt="application/x-postmate-v1+json";let mr=0;const oo={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},Qn=(t,e)=>(typeof e!="string"||t.origin===e)&&!!t.data&&(typeof t.data!="object"||"postmate"in t.data)&&t.data.type===tt&&!!oo[t.data.postmate];class io{constructor(e){te(this,"parent",void 0),te(this,"frame",void 0),te(this,"child",void 0),te(this,"events",{}),te(this,"childOrigin",void 0),te(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=n=>{if(!Qn(n,this.childOrigin))return!1;const{data:r,name:i}=((n||{}).data||{}).value||{};n.data.postmate==="emit"&&i in this.events&&this.events[i].forEach(a=>{a.call(this,r)})},this.parent.addEventListener("message",this.listener,!1)}get(e,...n){return new Promise(r=>{const i=++mr,a=u=>{u.data.uid===i&&u.data.postmate==="reply"&&(this.parent.removeEventListener("message",a,!1),r(u.data.value))};this.parent.addEventListener("message",a,!1),this.child.postMessage({postmate:"request",type:tt,property:e,args:n,uid:i},this.childOrigin)})}call(e,n){this.child.postMessage({postmate:"call",type:tt,property:e,data:n},this.childOrigin)}on(e,n){this.events[e]||(this.events[e]=[]),this.events[e].push(n)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class so{constructor(e){te(this,"model",void 0),te(this,"parent",void 0),te(this,"parentOrigin",void 0),te(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",n=>{if(!Qn(n,this.parentOrigin))return;const{property:r,uid:i,data:a,args:u}=n.data;n.data.postmate!=="call"?((h,w,U)=>{const R=typeof h[w]=="function"?h[w].apply(null,U):h[w];return Promise.resolve(R)})(this.model,r,u).then(h=>{n.source.postMessage({property:r,postmate:"reply",type:tt,uid:i,value:h},n.origin)}):r in this.model&&typeof this.model[r]=="function"&&this.model[r](a)})}emit(e,n){this.parent.postMessage({postmate:"emit",type:tt,value:{name:e,data:n}},this.parentOrigin)}}class er{constructor(e){te(this,"container",void 0),te(this,"parent",void 0),te(this,"frame",void 0),te(this,"child",void 0),te(this,"childOrigin",void 0),te(this,"url",void 0),te(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){const n=(a=>{const u=document.createElement("a");u.href=a;const h=u.protocol.length>4?u.protocol:window.location.protocol,w=u.host.length?u.port==="80"||u.port==="443"?u.hostname:u.host:window.location.host;return u.origin||`${h}//${w}`})(e=e||this.url);let r,i=0;return new Promise((a,u)=>{const h=U=>!!Qn(U,n)&&(U.data.postmate==="handshake-reply"?(clearInterval(r),this.parent.removeEventListener("message",h,!1),this.childOrigin=U.origin,a(new io(this))):u("Failed handshake"));this.parent.addEventListener("message",h,!1);const w=()=>{i++,this.child.postMessage({postmate:"handshake",type:tt,model:this.model},n),i===5&&clearInterval(r)};this.frame.addEventListener("load",()=>{w(),r=setInterval(w,500)}),this.frame.src=e})}destroy(){this.frame.parentNode.removeChild(this.frame)}}te(er,"debug",!1),te(er,"Model",void 0);class ao{constructor(e){te(this,"child",void 0),te(this,"model",void 0),te(this,"parent",void 0),te(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((e,n)=>{const r=i=>{if(i.data.postmate){if(i.data.postmate==="handshake"){this.child.removeEventListener("message",r,!1),i.source.postMessage({postmate:"handshake-reply",type:tt},i.origin),this.parentOrigin=i.origin;const a=i.data.model;return a&&Object.keys(a).forEach(u=>{this.model[u]=a[u]}),e(new so(this))}return n("Handshake Reply Failed")}};this.child.addEventListener("message",r,!1)})}}function sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const{importHTML:co,createSandboxContainer:lo}=window.QSandbox||{};function uo(t,e){return t.startsWith("http")?fetch(t,e):(t=t.replace("file://",""),new Promise(async(n,r)=>{try{const i=await window.apis.doAction(["readFile",t]);n({text:()=>i})}catch(i){console.error(i),r(i)}}))}class fo extends bt(){constructor(e){super(),sn(this,"_pluginLocal",void 0),sn(this,"_frame",void 0),sn(this,"_root",void 0),sn(this,"_loaded",!1),sn(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose(()=>{this._unmount()})}async load(){const{name:e,entry:n}=this._pluginLocal.options;if(this.loaded||!n)return;const{template:r,execScripts:i}=await co(n,{fetch:uo});this._mount(r,document.body);const a=lo(e,{elementGetter:()=>{var h;return(h=this._root)===null||h===void 0?void 0:h.firstChild}}).instance.proxy;a.__shadow_mode__=!0,a.LSPluginLocal=this._pluginLocal,a.LSPluginShadow=this,a.LSPluginUser=a.logseq=new fr(this._pluginLocal.toJSON(),this._pluginLocal.caller);const u=await i(a,!0);this._unmountFns.push(u.unmount),this._loaded=!0}_mount(e,n){const r=this._frame=document.createElement("div");r.classList.add("lsp-shadow-sandbox"),r.id=this._pluginLocal.id,this._root=r.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,n.appendChild(r),this.emit("mounted")}_unmount(){for(const e of this._unmountFns)e&&e.call(null)}destroy(){var e,n;(e=this.frame)===null||e===void 0||(n=e.parentNode)===null||n===void 0||n.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return(e=this._root)===null||e===void 0?void 0:e.firstChild}get frame(){return this._frame}}function Ye(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const ut=$e()("LSPlugin:caller"),an="#await#response#",ho="#lspmsg#",gr="#lspmsg#error#",jn=t=>`#lspmsg#${t}`;class po extends bt(){constructor(e){super(),Ye(this,"_pluginLocal",void 0),Ye(this,"_connected",!1),Ye(this,"_parent",void 0),Ye(this,"_child",void 0),Ye(this,"_shadow",void 0),Ye(this,"_status",void 0),Ye(this,"_userModel",{}),Ye(this,"_call",void 0),Ye(this,"_callUserModel",void 0),Ye(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){if(this._connected)return;const n=this,r=this._pluginLocal!=null;let i=0;const a=new Map,u=_e(6e4),h=this._extendUserModel({"#lspmsg#ready#":async R=>{h[jn(R?.pid)]=({type:D,payload:W})=>{ut(`[host (_call) -> *user] ${this._debugTag}`,D,W),n.emit(D,W)},await u.resolve()},"#lspmsg#beforeunload#":async R=>{const D=_e(1e4);n.emit("beforeunload",Object.assign({actor:D},R)),await D.promise},"#lspmsg#settings#":async({type:R,payload:D})=>{n.emit("settings:changed",D)},[ho]:async({ns:R,type:D,payload:W})=>{ut(`[host (async) -> *user] ${this._debugTag} ns=${R} type=${D}`,W),R&&R.startsWith("hook")?n.emit(`${R}:${D}`,W):n.emit(D,W)},"#lspmsg#reply#":({_sync:R,result:D})=>{if(ut(`[sync host -> *user] #${R}`,D),a.has(R)){const W=a.get(R);W&&(D!=null&&D.hasOwnProperty(gr)?W.reject(D[gr]):W.resolve(D),a.delete(R))}},...e});var w;if(r)return await u.promise,JSON.parse(JSON.stringify((w=this._pluginLocal)===null||w===void 0?void 0:w.toJSON()));const U=new ao(h).sendHandshakeReply();return this._status="pending",await U.then(R=>{this._child=R,this._connected=!0,this._call=async(D,W={},Q)=>{if(Q){const Z=++i;a.set(Z,Q),W._sync=Z,Q.setTag(`async call #${Z}`),ut(`async call #${Z}`)}return R.emit(jn(h.baseInfo.id),{type:D,payload:W}),Q?.promise},this._callUserModel=async(D,W)=>{try{h[D](W)}catch{ut(`[model method] #${D} not existed`)}},setInterval(()=>{if(a.size>100)for(const[D,W]of a)W.settled&&a.delete(D)},18e5)}).finally(()=>{this._status=void 0}),await u.promise,h.baseInfo}async call(e,n={}){var r;return(r=this._call)===null||r===void 0?void 0:r.call(this,e,n)}async callAsync(e,n={}){var r;const i=_e(1e4);return(r=this._call)===null||r===void 0?void 0:r.call(this,e,n,i)}async callUserModel(e,...n){var r;return(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[e,...n])}async callUserModelAsync(e,...n){var r;return e=`${an}${e}`,(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[e,...n])}async _setupIframeSandbox(){const e=this._pluginLocal,n=e.id,r=`${n}_lsp_main`,i=new URL(e.options.entry);i.searchParams.set("__v__",e.options.version);const a=document.querySelector(`#${r}`);a&&a.parentElement.removeChild(a);const u=document.createElement("div");u.classList.add("lsp-iframe-sandbox-container"),u.id=r,u.dataset.pid=n;try{var h;const D=(h=await this._pluginLocal._loadLayoutsData())===null||h===void 0?void 0:h.$$0;if(D){u.dataset.inited_layout="true";let{width:W,height:Q,left:Z,top:se,vw:me,vh:Ie}=D;Z=Math.max(Z,0),Z=typeof me=="number"?`${Math.min(100*Z/me,99)}%`:`${Z}px`,se=Math.max(se,45),se=typeof Ie=="number"?`${Math.min(100*se/Ie,99)}%`:`${se}px`,Object.assign(u.style,{width:W+"px",height:Q+"px",left:Z,top:se})}}catch(D){console.error("[Restore Layout Error]",D)}document.body.appendChild(u);const w=new er({id:n+"_iframe",container:u,url:i.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}});let U,R=w.sendHandshake();return this._status="pending",new Promise((D,W)=>{U=setTimeout(()=>{W(new Error("handshake Timeout")),w.destroy()},4e3),R.then(Q=>{this._parent=Q,this._connected=!0,this.emit("connected"),Q.on(jn(e.id),({type:Z,payload:se})=>{var me,Ie;ut("[user -> *host] ",Z,se),(me=this._pluginLocal)===null||me===void 0||me.emit(Z,se||{}),(Ie=this._pluginLocal)===null||Ie===void 0||Ie.caller.emit(Z,se||{})}),this._call=async(...Z)=>{await Q.call(jn(e.id),{type:Z[0],payload:Object.assign(Z[1]||{},{$$pid:e.id})})},this._callUserModel=async(Z,...se)=>{if(Z.startsWith(an))return await Q.get(Z.replace(an,""),...se);Q.call(Z,se?.[0])},D(null)}).catch(Q=>{W(Q)}).finally(()=>{clearTimeout(U)})}).catch(D=>{throw ut("[iframe sandbox] error",D),D}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const e=this._pluginLocal,n=this._shadow=new fo(e);try{this._status="pending",await n.load(),this._connected=!0,this.emit("connected"),this._call=async(r,i={},a)=>{var u;return a&&(i.actor=a),(u=this._pluginLocal)===null||u===void 0||u.emit(r,Object.assign(i,{$$pid:e.id})),a?.promise},this._callUserModel=async(...r)=>{var i;let a=r[0];(i=a)!==null&&i!==void 0&&i.startsWith(an)&&(a=a.replace(an,""));const u=r[1]||{},h=this._userModel[a];typeof h=="function"&&await h.call(null,u)}}catch(r){throw ut("[shadow sandbox] error",r),r}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return(e=this._parent)===null||e===void 0?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return(e=this._shadow)===null||e===void 0?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return(e=this._parent)===null||e===void 0?void 0:e.frame}_getSandboxShadowRoot(){var e;return(e=this._shadow)===null||e===void 0?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let n=null;this._parent&&(n=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(n=this._getSandboxShadowContainer(),this._shadow.destroy()),(e=n)===null||e===void 0||e.parentNode.removeChild(n)}}function vr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class yr{constructor(e,n){vr(this,"ctx",void 0),vr(this,"opts",void 0),this.ctx=e,this.opts=n}get ctxId(){return this.ctx.baseInfo.id}setItem(e,n){var r;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,n,(r=this.opts)===null||r===void 0?void 0:r.assets]})}getItem(e){var n;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}removeItem(e){var n;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(e=this.opts)===null||e===void 0?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(e=this.opts)===null||e===void 0?void 0:e.assets]})}hasItem(e){var n;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,(n=this.opts)===null||n===void 0?void 0:n.assets]})}}class mo{constructor(e){var n,r,i;i=void 0,(r="ctx")in(n=this)?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...n){var r,i;const a=this.ensureHostScope();return e=(r=j(e))===null||r===void 0?void 0:r.toLowerCase(),(i=a.logseq.api["exper_"+e])===null||i===void 0?void 0:i.apply(a,n)}async loadScripts(...e){(e=e.map(n=>n!=null&&n.startsWith("http")?n:this.ctx.resolveResourceFullUrl(n))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,n){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,n)}registerExtensionsEnhancer(e,n){const r=this.ensureHostScope();return e==="katex"&&r.katex&&n(r.katex).catch(console.error),r.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,n)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function Tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const br=t=>`task_callback_${t}`;class go{constructor(e,n,r={}){Tt(this,"_client",void 0),Tt(this,"_requestId",void 0),Tt(this,"_requestOptions",void 0),Tt(this,"_promise",void 0),Tt(this,"_aborted",!1),this._client=e,this._requestId=n,this._requestOptions=r,this._promise=new Promise((h,w)=>{if(!this._requestId)return w(null);this._client.once(br(this._requestId),U=>{U&&U instanceof Error?w(U):h(U)})});const{success:i,fail:a,final:u}=this._requestOptions;this._promise.then(h=>{i?.(h)}).catch(h=>{a?.(h)}).finally(()=>{u?.()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class tr extends rn.EventEmitter{constructor(e){super(),Tt(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",n=>{const r=n?.requestId;r&&this.emit(br(r),n?.payload)})}static createRequestTask(e,n,r){return new go(e,n,r)}async _request(e){const n=this.ctx.baseInfo.id,{success:r,fail:i,final:a,...u}=e,h=this.ctx.Experiments.invokeExperMethod("request",n,u),w=tr.createRequestTask(this.ctx.Request,h,e);return u.abortable?w:w.promise}get ctx(){return this._ctx}}const vo=gn(Object.keys,Object);var yo=Object.prototype.hasOwnProperty;const bo=function(t){if(!Rt(t))return vo(t);var e=[];for(var n in Object(t))yo.call(t,n)&&n!="constructor"&&e.push(n);return e},nr=function(t){return mt(t)?kt(t):bo(t)},_o=function(t,e){return t&&fn(t,e,nr)},wo=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},xo=function(t){return this.__data__.has(t)};function In(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Ne;++e<n;)this.add(t[e])}In.prototype.add=In.prototype.push=wo,In.prototype.has=xo;const Co=In,Eo=function(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1},So=function(t,e){return t.has(e)},_r=function(t,e,n,r,i,a){var u=1&n,h=t.length,w=e.length;if(h!=w&&!(u&&w>h))return!1;var U=a.get(t),R=a.get(e);if(U&&R)return U==e&&R==t;var D=-1,W=!0,Q=2&n?new Co:void 0;for(a.set(t,e),a.set(e,t);++D<h;){var Z=t[D],se=e[D];if(r)var me=u?r(se,Z,D,e,t,a):r(Z,se,D,t,e,a);if(me!==void 0){if(me)continue;W=!1;break}if(Q){if(!Eo(e,function(Ie,Ve){if(!So(Q,Ve)&&(Z===Ie||i(Z,Ie,n,r,a)))return Q.push(Ve)})){W=!1;break}}else if(Z!==se&&!i(Z,se,n,r,a)){W=!1;break}}return a.delete(t),a.delete(e),W},Ao=function(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n},ko=function(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n};var wr=l?l.prototype:void 0,rr=wr?wr.valueOf:void 0;const Oo=function(t,e,n,r,i,a,u){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new ot(t),new ot(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return y(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var h=Ao;case"[object Set]":var w=1&r;if(h||(h=ko),t.size!=e.size&&!w)return!1;var U=u.get(t);if(U)return U==e;r|=2,u.set(t,e);var R=_r(h(t),h(e),r,i,a,u);return u.delete(t),R;case"[object Symbol]":if(rr)return rr.call(t)==rr.call(e)}return!1},jo=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},Io=function(t,e,n){var r=e(t);return Me(t)?r:jo(r,n(t))},To=function(t,e){for(var n=-1,r=t==null?0:t.length,i=0,a=[];++n<r;){var u=t[n];e(u,n,t)&&(a[i++]=u)}return a},Mo=function(){return[]};var Fo=Object.prototype.propertyIsEnumerable,xr=Object.getOwnPropertySymbols;const Lo=xr?function(t){return t==null?[]:(t=Object(t),To(xr(t),function(e){return Fo.call(t,e)}))}:Mo,Cr=function(t){return Io(t,nr,Lo)};var No=Object.prototype.hasOwnProperty;const Po=function(t,e,n,r,i,a){var u=1&n,h=Cr(t),w=h.length;if(w!=Cr(e).length&&!u)return!1;for(var U=w;U--;){var R=h[U];if(!(u?R in e:No.call(e,R)))return!1}var D=a.get(t),W=a.get(e);if(D&&W)return D==e&&W==t;var Q=!0;a.set(t,e),a.set(e,t);for(var Z=u;++U<w;){var se=t[R=h[U]],me=e[R];if(r)var Ie=u?r(me,se,R,e,t,a):r(se,me,R,t,e,a);if(!(Ie===void 0?se===me||i(se,me,n,r,a):Ie)){Q=!1;break}Z||(Z=R=="constructor")}if(Q&&!Z){var Ve=t.constructor,Ln=e.constructor;Ve==Ln||!("constructor"in t)||!("constructor"in e)||typeof Ve=="function"&&Ve instanceof Ve&&typeof Ln=="function"&&Ln instanceof Ln||(Q=!1)}return a.delete(t),a.delete(e),Q},or=Oe(s,"DataView"),ir=Oe(s,"Promise"),sr=Oe(s,"Set"),ar=Oe(s,"WeakMap");var Er="[object Map]",Sr="[object Promise]",Ar="[object Set]",kr="[object WeakMap]",Or="[object DataView]",Uo=X(or),Ro=X(Te),Do=X(ir),$o=X(sr),zo=X(ar),wt=he;(or&&wt(new or(new ArrayBuffer(1)))!=Or||Te&&wt(new Te)!=Er||ir&&wt(ir.resolve())!=Sr||sr&&wt(new sr)!=Ar||ar&&wt(new ar)!=kr)&&(wt=function(t){var e=he(t),n=e=="[object Object]"?t.constructor:void 0,r=n?X(n):"";if(r)switch(r){case Uo:return Or;case Ro:return Er;case Do:return Sr;case $o:return Ar;case zo:return kr}return e});const jr=wt;var Ir="[object Arguments]",Tr="[object Array]",Tn="[object Object]",Mr=Object.prototype.hasOwnProperty;const qo=function(t,e,n,r,i,a){var u=Me(t),h=Me(e),w=u?Tr:jr(t),U=h?Tr:jr(e),R=(w=w==Ir?Tn:w)==Tn,D=(U=U==Ir?Tn:U)==Tn,W=w==U;if(W&&le(t)){if(!le(e))return!1;u=!0,R=!1}if(W&&!R)return a||(a=new Xe),u||et(t)?_r(t,e,n,r,i,a):Oo(t,e,w,n,r,i,a);if(!(1&n)){var Q=R&&Mr.call(t,"__wrapped__"),Z=D&&Mr.call(e,"__wrapped__");if(Q||Z){var se=Q?t.value():t,me=Z?e.value():e;return a||(a=new Xe),i(se,me,n,r,a)}}return!!W&&(a||(a=new Xe),Po(t,e,n,r,i,a))},Fr=function t(e,n,r,i,a){return e===n||(e==null||n==null||!be(e)&&!be(n)?e!=e&&n!=n:qo(e,n,r,i,t,a))},Bo=function(t,e,n,r){var i=n.length,a=i,u=!r;if(t==null)return!a;for(t=Object(t);i--;){var h=n[i];if(u&&h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++i<a;){var w=(h=n[i])[0],U=t[w],R=h[1];if(u&&h[2]){if(U===void 0&&!(w in t))return!1}else{var D=new Xe;if(r)var W=r(U,R,w,t,e,D);if(!(W===void 0?Fr(R,U,3,r,D):W))return!1}}return!0},Lr=function(t){return t==t&&!Fe(t)},Ho=function(t){for(var e=nr(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Lr(i)]}return e},Nr=function(t,e){return function(n){return n!=null&&n[t]===e&&(e!==void 0||t in Object(n))}},Wo=function(t){var e=Ho(t);return e.length==1&&e[0][2]?Nr(e[0][0],e[0][1]):function(n){return n===t||Bo(n,t,e)}},cr=function(t){return typeof t=="symbol"||be(t)&&he(t)=="[object Symbol]"};var Go=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Jo=/^\w*$/;const lr=function(t,e){if(Me(t))return!1;var n=typeof t;return!(n!="number"&&n!="symbol"&&n!="boolean"&&t!=null&&!cr(t))||Jo.test(t)||!Go.test(t)||e!=null&&t in Object(e)};function ur(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var u=t.apply(this,r);return n.cache=a.set(i,u)||a,u};return n.cache=new(ur.Cache||Ne),n}ur.Cache=Ne;const Yo=ur;var Vo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zo=/\\(\\)?/g;const Ko=function(t){var e=Yo(t,function(r){return n.size===500&&n.clear(),r}),n=e.cache;return e}(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Vo,function(n,r,i,a){e.push(i?a.replace(Zo,"$1"):r||n)}),e}),Xo=function(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i};var Pr=l?l.prototype:void 0,Ur=Pr?Pr.toString:void 0;const Qo=function t(e){if(typeof e=="string")return e;if(Me(e))return Xo(e,t)+"";if(cr(e))return Ur?Ur.call(e):"";var n=e+"";return n=="0"&&1/e==-1/0?"-0":n},ei=function(t){return t==null?"":Qo(t)},Rr=function(t,e){return Me(t)?t:lr(t,e)?[t]:Ko(ei(t))},Mn=function(t){if(typeof t=="string"||cr(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e},Dr=function(t,e){for(var n=0,r=(e=Rr(e,t)).length;t!=null&&n<r;)t=t[Mn(e[n++])];return n&&n==r?t:void 0},ti=function(t,e,n){var r=t==null?void 0:Dr(t,e);return r===void 0?n:r},ni=function(t,e){return t!=null&&e in Object(t)},ri=function(t,e,n){for(var r=-1,i=(e=Rr(e,t)).length,a=!1;++r<i;){var u=Mn(e[r]);if(!(a=t!=null&&n(t,u)))break;t=t[u]}return a||++r!=i?a:!!(i=t==null?0:t.length)&&zt(i)&&At(u,i)&&(Me(t)||Et(t))},oi=function(t,e){return t!=null&&ri(t,e,ni)},ii=function(t,e){return lr(t)&&Lr(e)?Nr(Mn(t),e):function(n){var r=ti(n,t);return r===void 0&&r===e?oi(n,t):Fr(e,r,3)}},si=function(t){return function(e){return e?.[t]}},ai=function(t){return function(e){return Dr(e,t)}},ci=function(t){return lr(t)?si(Mn(t)):ai(t)},li=function(t){return typeof t=="function"?t:t==null?jt:typeof t=="object"?Me(t)?ii(t[0],t[1]):Wo(t):ci(t)},ui=function(t,e){var n={};return e=li(e),_o(t,function(r,i,a){Ct(n,e(r,i,a),r)}),n};function $r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class fi{constructor(e,n){$r(this,"ctx",void 0),$r(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=n,e._execCallableAPI("register-search-service",e.baseInfo.id,n.name,n.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:r=>(Me(r?.blocks)&&(r.blocks=r.blocks.map(i=>i&&ui(i,(a,u)=>`block/${u}`))),r)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([r,i])=>{const a=(u=>`service:search:${u}:${n.name}`)(r);e.caller.on(a,async u=>{if(g(n?.[i.f])){let h=null;try{h=await n[i.f].apply(n,(i.args||[]).map(w=>{if(u){if(w===!0)return u;if(u.hasOwnProperty(w)){const U=u[w];return delete u[w],U}}})),i.transformOutput&&(h=i.transformOutput(h))}catch(w){console.error("[SearchService] ",w),h=w}finally{i.reply&&e.caller.call(`${a}:reply`,h)}}})})}}function ze(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const di=Symbol.for("proxy-continue"),hi=$e()("LSPlugin:user"),zr=new ie("",{console:!0});function Mt(t,e,n){var r;if(typeof n!="function")return!1;const{key:i,label:a,desc:u,palette:h,keybinding:w,extras:U}=e,R=`SimpleCommandHook${i}${++Hr}`;this.Editor["on"+R](n),(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:i,label:a,type:t,desc:u,keybinding:w,extras:U},["editor/hook",R]],h]})}function qr(t){return!(typeof(e=t)!="string"||e.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e))||(zr.error(`#${t} is not a valid UUID string.`),!1);var e}let Fn=null,Br=new Map;const pi={async getInfo(t){return Fn||(Fn=await this._execCallableAPIAsync("get-app-info")),typeof t=="string"?Fn[t]:Fn},registerCommand:Mt,registerSearchService(t){if(Br.has(t.name))throw new Error(`SearchService: #${t.name} has registered!`);Br.set(t.name,new fi(this,t))},registerCommandPalette(t,e){const{key:n,label:r,keybinding:i}=t;return Mt.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:i},e)},registerCommandShortcut(t,e){const{binding:n}=t,r="$shortcut$",i=r+j(n);return Mt.call(this,r,{key:i,palette:!1,keybinding:t},e)},registerUIItem(t,e){var n;const r=this.baseInfo.id;(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-ui-item",args:[r,t,e]})},registerPageMenuItem(t,e){if(typeof e!="function")return!1;const n=t+"_"+this.baseInfo.id,r=t;Mt.call(this,"page-menu-item",{key:n,label:r},e)},onBlockRendererSlotted(t,e){if(!qr(t))return;const n=this.baseInfo.id,r=`hook:editor:${j(`slot:${t}`)}`;return this.caller.on(r,e),this.App._installPluginHook(n,r),()=>{this.caller.off(r,e),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(t,...e){var n;if(!(t=(n=t)===null||n===void 0?void 0:n.trim()))return;let[r,i]=t.split(".");if(!["models","commands"].includes(i?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const a=t.replace(`${r}.${i}.`,"");if(!r||!i||!a)throw new Error(`Illegal type of #${t} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,i.toLowerCase(),a,e)},setFullScreen(t){const e=(...n)=>this._callWin("setFullScreen",...n);t==="toggle"?this._callWin("isFullScreen").then(n=>{n?e():e(!0)}):t?e(!0):e()}};let Hr=0;const mi={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(t,e){var n;hi("Register slash command #",this.baseInfo.id,t,e),typeof e=="function"&&(e=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",e]]),e=e.map(r=>{const[i,...a]=r;if(i==="editor/hook"){let u=a[0],h=()=>{var U;(U=this.caller)===null||U===void 0||U.callUserModel(u)};typeof u=="function"&&(h=u);const w=`SlashCommandHook${i}${++Hr}`;r[1]=w,this.Editor["on"+w](h)}return r}),(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[t,e]]})},registerBlockContextMenuItem(t,e){if(typeof e!="function")return!1;const n=t+"_"+this.baseInfo.id;Mt.call(this,"block-context-menu-item",{key:n,label:t},e)},registerHighlightContextMenuItem(t,e,n){if(typeof e!="function")return!1;const r=t+"_"+this.baseInfo.id;Mt.call(this,"highlight-context-menu-item",{key:r,label:t,extras:n},e)},scrollToBlockInPage(t,e,n){const r="block-content-"+e;n!=null&&n.replaceState?this.App.replaceState("page",{name:t},{anchor:r}):this.App.pushState("page",{name:t},{anchor:r})}},gi={onBlockChanged(t,e){if(!qr(t))return;const n=this.baseInfo.id,r=`hook:db:${j(`block:${t}`)}`,i=({block:a,txData:u,txMeta:h})=>{a.uuid===t&&e(a,u,h)};return this.caller.on(r,i),this.App._installPluginHook(n,r),()=>{this.caller.off(r,i),this.App._uninstallPluginHook(n,r)}},datascriptQuery(t,...e){return e.pop(),e!=null&&e.some(n=>typeof n=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(t,...e):this._execCallableAPIAsync("datascript_query",t,...e)}},vi={},yi={},bi={makeSandboxStorage(){return new yr(this,{assets:!0})}};class fr extends bt(){constructor(e,n){super(),ze(this,"_baseInfo",void 0),ze(this,"_caller",void 0),ze(this,"_version","0.0.14"),ze(this,"_debugTag",""),ze(this,"_settingsSchema",void 0),ze(this,"_connected",!1),ze(this,"_ui",new Map),ze(this,"_mFileStorage",void 0),ze(this,"_mRequest",void 0),ze(this,"_mExperiments",void 0),ze(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=n,n.on("sys:ui:visible",r=>{r!=null&&r.toggle&&this.toggleMainUI()}),n.on("settings:changed",r=>{const i=Object.assign({},this.settings),a=Object.assign(this._baseInfo.settings,r);this.emit("settings:changed",{...a},i)}),n.on("beforeunload",async r=>{const{actor:i,...a}=r,u=this._beforeunloadCallback;try{u&&await u(a),i?.resolve(null)}catch(h){console.debug(`${n.debugTag} [beforeunload] `,h),i?.reject(h)}})}async ready(e,n){if(!this._connected)try{var r;typeof e=="function"&&(n=e,e={});let i=await this._caller.connectToParent(e);this._connected=!0,i=A(this._baseInfo,i),(r=i)!==null&&r!==void 0&&r.id&&(this._debugTag=this._caller.debugTag=`#${i.id} [${i.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(i.settings=function(a,u){const h=(u||[]).reduce((w,U)=>("default"in U&&(w[U.key]=U.default),w),{});return Object.assign(h,a)}(i.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(a){console.warn(a)}n&&n.call(this,i)}catch(i){console.error(`${this._debugTag} [Ready Error]`,i)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(e){typeof e=="function"&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){const n="settings:changed";return this.on(n,e),()=>this.off(n,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){const n={key:0,visible:!1,cursor:e?.restoreEditingCursor};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}showMainUI(e){const n={key:0,visible:!0,autoFocus:e?.autoFocus};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}toggleMainUI(){const n=this._ui.get(0);n&&n.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const e=this._ui.get(0);return!!(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(e=this)&&(((n=e.baseInfo)===null||n===void 0?void 0:n.effect)||!((r=e.baseInfo)!==null&&r!==void 0&&r.iir));var e,n,r}get logger(){return zr}get settings(){var e;return(e=this.baseInfo)===null||e===void 0?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),de(this._baseInfo.lsr,e)}_makeUserProxy(e,n){const r=this,i=this.caller;return new Proxy(e,{get(a,u,h){const w=a[u];return function(...U){if(w){const D=w.apply(r,U.concat(n));if(D!==di)return D}if(n){const D=u.toString().match(/^(once|off|on)/i);if(D!=null){const W=D[0].toLowerCase(),Q=D.input.slice(W.length),Z=W==="off",se=r.baseInfo.id,me=`hook:${n}:${j(Q)}`,Ie=U[0];i[W](me,Ie);const Ve=()=>{i.off(me,Ie),i.listenerCount(me)||r.App._uninstallPluginHook(se,me)};return Z?void Ve():(r.App._installPluginHook(se,me),Ve)}}let R=u;return["git","ui","assets"].includes(n)&&(R=n+"_"+R),i.callAsync("api:call",{tag:n,method:R,args:U})}}})}_execCallableAPIAsync(e,...n){return this._caller.callAsync("api:call",{method:e,args:n})}_execCallableAPI(e,...n){this._caller.call("api:call",{method:e,args:n})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(pi,"app")}get Editor(){return this._makeUserProxy(mi,"editor")}get DB(){return this._makeUserProxy(gi,"db")}get Git(){return this._makeUserProxy(vi,"git")}get UI(){return this._makeUserProxy(yi,"ui")}get Assets(){return this._makeUserProxy(bi,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new yr(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new tr(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new mo(this)),e}}function Wr(t,e){return new fr(t,e)}if(window.__LSP__HOST__==null){const t=new po(null);window.logseq=Wr({},t)}})(),J})())})(Dn,Dn.exports);Dn.exports;const wi=typeof atob=="function",xi=typeof btoa=="function",Ft=typeof Buffer=="function",Gr=typeof TextDecoder=="function"?new TextDecoder:void 0,Jr=typeof TextEncoder=="function"?new TextEncoder:void 0,Ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cn=Array.prototype.slice.call(Ci),Pn=(c=>{let f={};return c.forEach((O,q)=>f[O]=q),f})(cn),Ei=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Ee=String.fromCharCode.bind(String),Yr=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):c=>new Uint8Array(Array.prototype.slice.call(c,0)),Si=c=>c.replace(/=/g,"").replace(/[+\/]/g,f=>f=="+"?"-":"_"),Qr=c=>c.replace(/[^A-Za-z0-9\+\/]/g,""),Ai=c=>{let f,O,q,P,J="";const I=c.length%3;for(let d=0;d<c.length;){if((O=c.charCodeAt(d++))>255||(q=c.charCodeAt(d++))>255||(P=c.charCodeAt(d++))>255)throw new TypeError("invalid character found");f=O<<16|q<<8|P,J+=cn[f>>18&63]+cn[f>>12&63]+cn[f>>6&63]+cn[f&63]}return I?J.slice(0,I-3)+"===".substring(I):J},eo=xi?c=>btoa(c):Ft?c=>Buffer.from(c,"binary").toString("base64"):Ai,ki=Ft?c=>Buffer.from(c).toString("base64"):c=>{let O=[];for(let q=0,P=c.length;q<P;q+=4096)O.push(Ee.apply(null,c.subarray(q,q+4096)));return eo(O.join(""))},Oi=c=>{if(c.length<2){var f=c.charCodeAt(0);return f<128?c:f<2048?Ee(192|f>>>6)+Ee(128|f&63):Ee(224|f>>>12&15)+Ee(128|f>>>6&63)+Ee(128|f&63)}else{var f=65536+(c.charCodeAt(0)-55296)*1024+(c.charCodeAt(1)-56320);return Ee(240|f>>>18&7)+Ee(128|f>>>12&63)+Ee(128|f>>>6&63)+Ee(128|f&63)}},ji=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Ii=c=>c.replace(ji,Oi),Vr=Ft?c=>Buffer.from(c,"utf8").toString("base64"):Jr?c=>ki(Jr.encode(c)):c=>eo(Ii(c)),Ti=(c,f=!1)=>f?Si(Vr(c)):Vr(c),Mi=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Fi=c=>{switch(c.length){case 4:var f=(7&c.charCodeAt(0))<<18|(63&c.charCodeAt(1))<<12|(63&c.charCodeAt(2))<<6|63&c.charCodeAt(3),O=f-65536;return Ee((O>>>10)+55296)+Ee((O&1023)+56320);case 3:return Ee((15&c.charCodeAt(0))<<12|(63&c.charCodeAt(1))<<6|63&c.charCodeAt(2));default:return Ee((31&c.charCodeAt(0))<<6|63&c.charCodeAt(1))}},Li=c=>c.replace(Mi,Fi),Ni=c=>{if(c=c.replace(/\s+/g,""),!Ei.test(c))throw new TypeError("malformed base64.");c+="==".slice(2-(c.length&3));let f,O="",q,P;for(let J=0;J<c.length;)f=Pn[c.charAt(J++)]<<18|Pn[c.charAt(J++)]<<12|(q=Pn[c.charAt(J++)])<<6|(P=Pn[c.charAt(J++)]),O+=q===64?Ee(f>>16&255):P===64?Ee(f>>16&255,f>>8&255):Ee(f>>16&255,f>>8&255,f&255);return O},to=wi?c=>atob(Qr(c)):Ft?c=>Buffer.from(c,"base64").toString("binary"):Ni,Pi=Ft?c=>Yr(Buffer.from(c,"base64")):c=>Yr(to(c).split("").map(f=>f.charCodeAt(0))),Ui=Ft?c=>Buffer.from(c,"base64").toString("utf8"):Gr?c=>Gr.decode(Pi(c)):c=>Li(to(c)),Ri=c=>Qr(c.replace(/[-_]/g,f=>f=="-"?"+":"/")),Di=c=>Ui(Ri(c));const Zr=`.drawio-plugin__preview{position:relative;display:flex;justify-content:center;align-items:center;min-width:200px;max-width:100%;cursor:default}.drawio-plugin__preview>svg{max-width:100%}.drawio-plugin__preview>.overlay{display:none;position:absolute;inset:0;background-image:linear-gradient(var(--ls-primary-background-color),transparent)}.drawio-plugin__preview:hover>.overlay{display:block}.drawio-plugin__toolbar{display:none;position:absolute;top:0;left:0;right:0}.drawio-plugin__preview:hover .drawio-plugin__toolbar{display:flex;flex-direction:row;justify-content:space-between;align-content:center}.drawio-plugin__toolbar-actions{display:flex;flex-direction:row;align-content:center}.drawio-plugin__toolbar-actions button{display:inline-flex;cursor:pointer;margin-left:.25rem;margin-right:.25rem}
`;var no={exports:{}};(function(c){var f=Object.prototype.hasOwnProperty,O="~";function q(){}Object.create&&(q.prototype=Object.create(null),new q().__proto__||(O=!1));function P(y,_,v){this.fn=y,this.context=_,this.once=v||!1}function J(y,_,v,E,G){if(typeof v!="function")throw new TypeError("The listener must be a function");var b=new P(v,E||y,G),p=O?O+_:_;return y._events[p]?y._events[p].fn?y._events[p]=[y._events[p],b]:y._events[p].push(b):(y._events[p]=b,y._eventsCount++),y}function I(y,_){--y._eventsCount===0?y._events=new q:delete y._events[_]}function d(){this._events=new q,this._eventsCount=0}d.prototype.eventNames=function(){var _=[],v,E;if(this._eventsCount===0)return _;for(E in v=this._events)f.call(v,E)&&_.push(O?E.slice(1):E);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(v)):_},d.prototype.listeners=function(_){var v=O?O+_:_,E=this._events[v];if(!E)return[];if(E.fn)return[E.fn];for(var G=0,b=E.length,p=new Array(b);G<b;G++)p[G]=E[G].fn;return p},d.prototype.listenerCount=function(_){var v=O?O+_:_,E=this._events[v];return E?E.fn?1:E.length:0},d.prototype.emit=function(_,v,E,G,b,p){var x=O?O+_:_;if(!this._events[x])return!1;var m=this._events[x],$=arguments.length,L,M;if(m.fn){switch(m.once&&this.removeListener(_,m.fn,void 0,!0),$){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,v),!0;case 3:return m.fn.call(m.context,v,E),!0;case 4:return m.fn.call(m.context,v,E,G),!0;case 5:return m.fn.call(m.context,v,E,G,b),!0;case 6:return m.fn.call(m.context,v,E,G,b,p),!0}for(M=1,L=new Array($-1);M<$;M++)L[M-1]=arguments[M];m.fn.apply(m.context,L)}else{var V=m.length,F;for(M=0;M<V;M++)switch(m[M].once&&this.removeListener(_,m[M].fn,void 0,!0),$){case 1:m[M].fn.call(m[M].context);break;case 2:m[M].fn.call(m[M].context,v);break;case 3:m[M].fn.call(m[M].context,v,E);break;case 4:m[M].fn.call(m[M].context,v,E,G);break;default:if(!L)for(F=1,L=new Array($-1);F<$;F++)L[F-1]=arguments[F];m[M].fn.apply(m[M].context,L)}}return!0},d.prototype.on=function(_,v,E){return J(this,_,v,E,!1)},d.prototype.once=function(_,v,E){return J(this,_,v,E,!0)},d.prototype.removeListener=function(_,v,E,G){var b=O?O+_:_;if(!this._events[b])return this;if(!v)return I(this,b),this;var p=this._events[b];if(p.fn)p.fn===v&&(!G||p.once)&&(!E||p.context===E)&&I(this,b);else{for(var x=0,m=[],$=p.length;x<$;x++)(p[x].fn!==v||G&&!p[x].once||E&&p[x].context!==E)&&m.push(p[x]);m.length?this._events[b]=m.length===1?m[0]:m:I(this,b)}return this},d.prototype.removeAllListeners=function(_){var v;return _?(v=O?O+_:_,this._events[v]&&I(this,v)):(this._events=new q,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=O,d.EventEmitter=d,c.exports=d})(no);var $i=no.exports;const dr=_i($i);var hr=(c=>(c.Kennedy="kennedy",c.Min="min",c.Sketch="sketch",c.Simple="simple",c))(hr||{}),Ze=(c=>(c.Save="save",c.Exit="exit",c))(Ze||{});class zi{ui;dark;embed="1";proto="json";spin="1";constructor(){this.ui=logseq.settings?.ui??"kennedy",this.dark="auto"}}class qi{constructor(f){this.baseUrl=f}urlConfig={ui:"kennedy",dark:"auto",embed:"1",proto:"json",spin:"1"};async getUrl(){this.urlConfig=new zi;const{preferredThemeMode:f}=await logseq.App.getUserConfigs();this.urlConfig.dark=f==="light"?"0":"1";const O=new URLSearchParams(this.urlConfig);return`${this.baseUrl}?${O.toString()}`}}class Bi extends dr{configManager;iframeEl;ready=!1;messageEventEmitter=new dr;handleMessageEvent=f=>{if(typeof f.data!="string")return;let O;try{if(O=JSON.parse(f.data),!O.event)return}catch{}console.log(O),this.messageEventEmitter.emit(O.event,O)};handleSave=async()=>{this.sendAction({action:"export",format:"xmlsvg",background:"transparent"});const f=await this.waitFor("export"),O=f.data.indexOf(","),q=f.data.slice(O+1);this.emit("save",Di(q))};handleExit=async()=>{this.emit("exit"),this.hideFrame(),this.ready=!1};constructor(f,O){super(),this.configManager=O??new qi(f),window.addEventListener("message",this.handleMessageEvent),this.messageEventEmitter.on("init",()=>this.ready=!0),this.messageEventEmitter.on("save",this.handleSave),this.messageEventEmitter.on("exit",this.handleExit)}async waitFor(f){return new Promise(O=>{this.messageEventEmitter.once(f,q=>O(q))})}sendAction(f){this.ready&&this.iframeEl?.contentWindow?.postMessage(JSON.stringify(f),"*")}createFrame(){this.iframeEl=document.createElement("iframe"),document.getElementById("iframe-inner").appendChild(this.iframeEl)}hideFrame(){document.getElementById("iframe-wrap")?.style.setProperty("display","none"),this.iframeEl?.setAttribute("style","display: none;"),this.iframeEl?.removeAttribute("src")}async showFrame(){this.iframeEl||this.createFrame();const f=document.getElementById("iframe-wrap");f?.style.setProperty("display","block"),this.iframeEl?.removeAttribute("style"),this.iframeEl?.setAttribute("src",await this.configManager.getUrl()),this.configManager.urlConfig.dark==="1"?f?.classList.add("dark"):f?.classList.remove("dark")}async open(f){await this.showFrame(),await this.waitFor("init"),this.sendAction({action:"load",xml:f??""})}showTemplate(){this.sendAction({action:"template"})}}const Hi={id:"logseq-drawio-plugin",icon:"./logo.png"},Wi="preview",Gi="svg-container",Ji="close";class ln extends dr{rootEl;svgContentEl;closeButton;isShow=!1;_scale=1;_moveX=0;_moveY=0;handleScroll=f=>{f.deltaY<0?this.scale+=.1:f.deltaY>0&&(this.scale-=.1)};handleClose=()=>this.hide();handleKeyUp=f=>{this.isShow&&f.key==="Escape"&&this.hide()};handleMouseMove=f=>{console.log("mouse move",f);const{movementX:O,movementY:q}=f;this.moveX=this.moveX+O/this.scale,this.moveY=this.moveY+q/this.scale};handleSvgMouseDown=()=>{window.addEventListener("mousemove",this.handleMouseMove)};handleMouseUp=()=>{window.removeEventListener("mousemove",this.handleMouseMove)};constructor(f=Wi){super(),this.rootEl=document.getElementById(f),this.svgContentEl=this.rootEl.querySelector(`#${Gi}`),this.closeButton=this.rootEl.querySelector(`#${Ji}`),this.scale=1.2,window.addEventListener("keyup",this.handleKeyUp),this.svgContentEl.addEventListener("wheel",this.handleScroll),this.svgContentEl.addEventListener("mousedown",this.handleSvgMouseDown),window.addEventListener("mouseup",this.handleMouseUp),this.closeButton.addEventListener("click",this.handleClose)}set scale(f){this._scale=f,this.svgContentEl.style.setProperty("--preview-scale",`${f}`)}get scale(){return this._scale}set moveX(f){this._moveX=f,this.svgContentEl.style.setProperty("--preview-move-x",`${f}px`)}get moveX(){return this._moveX}set moveY(f){this._moveY=f,this.svgContentEl.style.setProperty("--preview-move-y",`${f}px`)}get moveY(){return this._moveY}show(f){this.rootEl.style.display="block",f&&(this.svgContentEl.innerHTML=f),this.isShow=!0,this.emit(ln.ShowEventName)}hide(){this.rootEl.style.removeProperty("display"),this.svgContentEl.innerHTML="",this.scale=1.2,this.moveX=0,this.moveY=0,this.isShow=!1,this.emit(ln.HideEventName)}static HideEventName="hide";static ShowEventName="show"}const Yi=c=>new RegExp(`\\{\\{renderer\\s*:drawio,\\s*${c}\\}\\}`,"i");function Vi(c){return/\.(drawio|svg)/i.test(c)}function pr(){logseq.UI.showMsg("file saved")}function ro(c){return`{{renderer :drawio, ${c}}}`}const Zi=async(c,f,O)=>{const q=logseq.Assets.makeSandboxStorage(),P=document.createElement("input");P.type="file";const J=await new Promise((y,_)=>{P.addEventListener("change",async()=>{const v=P.files?.[0];if(!v||!Vi(v.name)){_();return}const E=v.name;if(await q.hasItem(E)){logseq.UI.showMsg("file name already exists!"),_();return}const b=await v.text();y(b)}),P.click()});let I="";const d=async y=>{I||(I=`${Date.now()}.svg`,await logseq.Editor.editBlock(c,{pos:0}),await logseq.Editor.insertAtEditingCursor(ro(I))),await q.setItem(I,y),pr()};f.on(Ze.Save,d),f.once(Ze.Exit,()=>{console.log("off save event"),f.off(Ze.Save,d),logseq.hideMainUI()}),logseq.showMainUI(),O.show();try{await f.open(J)}catch(y){console.log("create file failed",y),logseq.hideMainUI()}finally{O.hide()}},Ki=async(c,f,O)=>{const q=logseq.Assets.makeSandboxStorage();let P="";const J=async I=>{P||(P=`${Date.now()}.svg`,await logseq.Editor.editBlock(c,{pos:0}),await logseq.Editor.insertAtEditingCursor(ro(P))),await q.setItem(P,I),pr()};f.on(Ze.Save,J),f.once(Ze.Exit,()=>{console.log("off save event"),f.off(Ze.Save,J),logseq.hideMainUI()}),logseq.showMainUI(),O.show();try{await f.open()}catch(I){console.log("create file failed",I),logseq.hideMainUI()}finally{O.hide()}f.showTemplate()},Xi=async(c,f,O)=>{const q=logseq.Assets.makeSandboxStorage(),P=c.dataset.fileName,J=c.dataset.uuid,I=await q.getItem(P);O.show(),logseq.showMainUI();try{await f.open(I)}catch(y){console.error("open drawio failed",y),logseq.hideMainUI();return}finally{O.hide()}const d=y=>{q.setItem(P,y),pr()};f.on(Ze.Save,d),f.once(Ze.Exit,()=>{f.off(Ze.Save,d),logseq.hideMainUI(),logseq.Editor.editBlock(J)})},Qi=async c=>{const f=logseq.Assets.makeSandboxStorage(),O=c.dataset.fileName,q=c.dataset.uuid;await f.removeItem(O);const P=await logseq.Editor.getBlock(q);if(!P)return;const J=P.content.replace(Yi(O),"");logseq.Editor.updateBlock(q,J)},es=async(c,f)=>{const O=logseq.Assets.makeSandboxStorage(),q=c.dataset.fileName,P=await O.getItem(q);if(!P){logseq.UI.showMsg(`file(${q}) is not found!`,"error");return}logseq.showMainUI(),f.show(P),f.once(ln.HideEventName,()=>{logseq.hideMainUI()})},ts=async c=>{const f=logseq.Assets.makeSandboxStorage(),O=c.dataset.fileName,q=await f.getItem(O);if(!q){logseq.UI.showMsg(`file(${O}) is not found!`,"error");return}const P=new Blob([q]),J=URL.createObjectURL(P),I=document.createElement("a");I.href=J,I.download=O,I.click(),setTimeout(()=>{URL.revokeObjectURL(J),I.href=""})},ns="spinner";class rs{rootEl;constructor(f=ns){this.rootEl=document.getElementById(f)}hide(){this.rootEl.style.removeProperty("display")}show(){this.rootEl.style.display="block"}}const os=[{key:"ui",title:"UI",default:hr.Kennedy,description:"draw.io ui",type:"enum",enumChoices:Object.values(hr),enumPicker:"radio"}],is=Hi.id;let Un,Kr,Rn;function Xr(){console.info(`#${is}: MAIN`),Un=new Bi("drawio/index.html"),Kr=new ln,Rn=new rs;const c=logseq.Assets.makeSandboxStorage();if({}.VITE_IS_MOCK){const f=document.createElement("style");f.innerHTML=Zr,document.head.appendChild(f)}else{const f=()=>({edit:O=>Xi(O,Un,Rn),remove:Qi,preview:O=>es(O,Kr),download:ts});logseq.provideModel(f()),logseq.setMainUIInlineStyle({zIndex:100}),logseq.provideStyle(Zr),logseq.Editor.registerSlashCommand("import drawio file",({uuid:O})=>Zi(O,Un,Rn)),logseq.Editor.registerSlashCommand("create drawio file",({uuid:O})=>Ki(O,Un,Rn)),logseq.App.onMacroRendererSlotted(async({slot:O,payload:q})=>{const[P,J]=q.arguments;if(P!==":drawio")return;const d=(await c.getItem(J))?.replace(/content=\".*?\"/,""),_=`<img style="background-color: white;" src="data:image/svg+xml;base64,${Ti(d??"")}">`;return logseq.provideUI({key:J,slot:O,reset:!0,template:`
<div class="drawio-plugin__preview">
  ${_}
  <div class="overlay"></div>
  <div class="drawio-plugin__toolbar">
    <div class="drawio-plugin__toolbar-title"></div>
    <div class="drawio-plugin__toolbar-actions">
      <button data-file-name="${J}" data-uuid="${q.uuid}" data-on-click="edit">
        <svg width="18" height="18" stroke="currentColor" viewBox="0 0 24 24" fill="none"><path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" stroke-width="2" stroke-linejoin="round" stroke-linecap="round"></path></svg>
      </button>
      <button data-file-name="${J}" data-uuid="${q.uuid}" data-on-click="download">
        <svg viewBox="0 0 1024 1024" width="18" height="18" stroke-width="2" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M810.666667 938.666667H213.333333c-72.533333 0-128-55.466667-128-128v-170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v170.666667c0 25.6 17.066667 42.666667 42.666666 42.666666h597.333334c25.6 0 42.666667-17.066667 42.666666-42.666666v-170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v170.666667c0 72.533333-55.466667 128-128 128z"></path><path d="M512 682.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333334c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l183.466667 183.466667 183.466667-183.466667c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333334c-8.533333 8.533333-17.066667 12.8-29.866667 12.8z"></path><path d="M512 682.666667c-25.6 0-42.666667-17.066667-42.666667-42.666667V128c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v512c0 25.6-17.066667 42.666667-42.666667 42.666667z"></path></svg>
      </button>
      <button data-file-name="${J}" data-uuid="${q.uuid}" data-on-click="remove">
        <svg width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><line x1="4" y1="7" x2="20" y2="7"></line><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path></svg>
      </button data-file-name="${J}" data-uuid="${q.uuid}" data-on-click="max">
      <button data-file-name="${J}" data-uuid="${q.uuid}" data-on-click="preview">
        <svg  width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 8v-2a2 2 0 0 1 2 -2h2"></path><path d="M4 16v2a2 2 0 0 0 2 2h2"></path><path d="M16 4h2a2 2 0 0 1 2 2v2"></path><path d="M16 20h2a2 2 0 0 0 2 -2v-2"></path></svg>
      </button>
    </div>
  </div>
</div>
`})})}}({}).VITE_IS_MOCK?Xr():logseq.useSettingsSchema(os).ready(Xr).catch(console.error);
